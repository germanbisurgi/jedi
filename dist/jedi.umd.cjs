(function(z,O){typeof exports=="object"&&typeof module<"u"?module.exports=O():typeof define=="function"&&define.amd?define(O):(z=typeof globalThis<"u"?globalThis:z||self,z.Jedi=O())})(this,function(){"use strict";function z(){const n=[];return function(e,t){if(typeof t!="object"||t===null)return t;for(;n.length>0&&n.at(-1)!==this;)n.pop();return n.includes(t)?"[Circular]":(n.push(t),t)}}function O(n){if(!(typeof n>"u"))return JSON.parse(JSON.stringify(n,z()))}function it(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Fe(n,e,t){return n.replace(new RegExp(it(e),"g"),t)}function A(n){return Fe(Fe(n,"#","root"),"/","-")}function N(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Se(n){return Object.keys(n).sort().reduce((e,t)=>(e[t]=n[t],e),{})}function Oe(n,e){return f(n)&&f(e)&&(n=Se(n),e=Se(e)),JSON.stringify(n)===JSON.stringify(e)}function Te(n,e){return!Oe(n,e)}function je(n){return n===null}function d(n){return typeof n<"u"}function D(n){return typeof n>"u"}function M(n){return typeof n=="number"}function B(n){return M(n)&&n===Math.floor(n)}function R(n){return typeof n=="string"}function T(n){return typeof n=="boolean"}function x(n){return Array.isArray(n)}function f(n){return!je(n)&&!x(n)&&typeof n=="object"}function nt(n){let e="any";return M(n)?e=B(n)?"integer":"number":R(n)?e="string":T(n)?e="boolean":x(n)?e="array":je(n)?e="null":f(n)&&(e="object"),e}function K(n,...e){if(!e.length)return n;const t=e.shift();return f(n)&&f(t)&&Object.keys(t).forEach(s=>{f(t[s])?(n[s]||Object.assign(n,{[s]:{}}),K(n[s],t[s])):Object.assign(n,{[s]:t[s]})}),K(n,...e)}function rt(n,e){return Object.keys(e).forEach(function(t){t in n&&typeof n[t]==typeof e[t]&&(n[t]=e[t])}),n}function at(n,e){const t=e.split(".");let s=n;for(const r of t)if(Array.isArray(s)&&/^\d+$/.test(r)){const i=parseInt(r);if(i>=0&&i<s.length)s=s[i];else return}else if(N(s,r))s=s[r];else return;return s}function E(n,e){return n.replace(/{{(.*?)}}/g,t=>{t=t.replace(/\s/g,"");const s=t.split(/{{|}}/)[1];return at(e,s)})}function ot(n,e,t){return Math.max(e,Math.min(n,t))}function Ue(n){const e=[],t=new Set;for(const s of n){const r=JSON.stringify(s);t.has(r)||(t.add(r),e.push(s))}return e}function ke(n){return f(n.additionalProperties)||T(n.additionalProperties)?n.additionalProperties:void 0}function lt(n){return f(n.propertyNames)||T(n.propertyNames)?n.propertyNames:void 0}function Me(n){return x(n.allOf)?n.allOf:void 0}function $(n){return x(n.anyOf)?n.anyOf:void 0}function ct(n){return n.const}function dt(n){return f(n.contains)||T(n.contains)?n.contains:void 0}function ht(n){return n.default}function Ke(n){return f(n.dependentRequired)?n.dependentRequired:void 0}function ut(n){return f(n.dependentSchemas)?n.dependentSchemas:void 0}function j(n){return R(n.description)?n.description:void 0}function Ve(n){return f(n.else)||T(n.else)?n.else:void 0}function V(n){if(x(n.enum)&&n.enum.length>0)return n.enum}function pt(n){return M(n.exclusiveMaximum)?n.exclusiveMaximum:void 0}function mt(n){return M(n.exclusiveMinimum)?n.exclusiveMinimum:void 0}function q(n){return R(n.format)?n.format:void 0}function Re(n){if(f(n.if)||T(n.if))return n.if}function $e(n){return f(n.items)||T(n.items)?n.items:void 0}function ft(n){return M(n.maximum)?n.maximum:void 0}function gt(n){if(B(n.maxContains)&&n.maxContains>=0)return n.maxContains}function ze(n){if(B(n.maxItems)&&n.maxItems>=0)return n.maxItems}function bt(n){if(B(n.maxLength)&&n.maxLength>=0)return n.maxLength}function vt(n){if(B(n.maxProperties))return n.maxProperties}function Ct(n){return M(n.minimum)?n.minimum:void 0}function yt(n){if(B(n.minContains)&&n.minContains>=0)return n.minContains}function Je(n){if(B(n.minItems)&&n.minItems>=0)return n.minItems}function Et(n){if(B(n.minLength)&&n.minLength>=0)return n.minLength}function Lt(n){if(B(n.minProperties)&&n.minProperties>=0)return n.minProperties}function xt(n){if(M(n.multipleOf)&&n.multipleOf>=0)return n.multipleOf}function It(n){return f(n.not)||T(n.not)?n.not:void 0}function m(n,e){return n.options&&n.options[e]?n.options[e]:void 0}function Ge(n,e){return n["x-options"]&&n["x-options"][e]?n["x-options"][e]:void 0}function wt(n){return R(n.pattern)?n.pattern:void 0}function be(n){return f(n.patternProperties)?n.patternProperties:void 0}function He(n){return x(n.prefixItems)?n.prefixItems:void 0}function ve(n){return f(n.properties)?n.properties:void 0}function Ze(n){return T(n.readOnly)?n.readOnly:void 0}function _e(n){return x(n.required)?[...new Set(n.required)]:void 0}function Be(n){return f(n.then)||T(n.then)?n.then:void 0}function I(n){return R(n.title)?n.title:void 0}function H(n){if(R(n.type)||x(n.type))return n.type}function J(n){return x(n.oneOf)?n.oneOf:void 0}function At(n){return T(n.unevaluatedProperties)?n.unevaluatedProperties:void 0}function Pt(n){return T(n.uniqueItems)?n.uniqueItems:void 0}function G(n,e,t,s){let r=[];const i=Me(t);return d(i)&&i.forEach(a=>{const o=new P({refParser:n.refParser,schema:a,data:e,rootName:s}),l=o.getErrors();o.destroy(),r=[...r,...l],r=Ue(r)}),r}const b={errorAdditionalProperties:'Has additional property "{{ property }}" but no additional properties are allowed.',errorAnyOf:"Must validate against at least one of the provided schemas.",errorConst:"Must have value of: {{ const }}.",errorContains:"Must contain at least one item matching the provided schema.",errorDependentRequired:"Must have the required properties: {{ dependentRequired }}.",errorEnum:"Must be one of the enumerated values: {{ enum }}.",errorExclusiveMaximum:"Must be less than {{ exclusiveMaximum }}.",errorExclusiveMinimum:"Must be greater than {{ exclusiveMinimum }}.",errorFormat:"Must be a valid {{ format }}.",errorItems:"Must have items that validate against the provided schema.",errorMaximum:"Must be at most {{ maximum }}.",errorMaxItems:"Must have at most {{ maxItems }} items.",errorMaxLength:"Must be at most {{ maxLength }} characters long.",errorMaxProperties:"Must have at most {{ maxProperties }} properties.",errorMaxContains:"Must contain at most {{ maxContains }} items matching the provided schema. It currently contains {{ counter }}.",errorMinContains:"Must contain at least {{ minContains }} items matching the provided schema. It currently contains {{ counter }}.",errorMinimum:"Must be at least {{ minimum }}.",errorMinItems:"Must have at least {{ minItems }} items.",errorMinLength:"Must be at least {{ minLength }} characters long.",errorMinProperties:"Must have at least {{ minProperties }} properties.",errorMultipleOf:"Must be multiple of {{ multipleOf }}.",errorNot:"Must not validate against the provided schema.",errorOneOf:"Must validate against exactly one of the provided schemas. It currently validates against {{ counter }} of the schemas.",errorPattern:'Must match the pattern: "{{ pattern }}".',errorPrefixItems:"Item {{ index }} fails validation.",errorPropertyNames:'Property name "{{ propertyName }}" fails validation.',errorRequired:"Must have the required properties: {{ required }}.",errorType:"Must be of type {{ type }}.",errorUnevaluatedProperties:'Has invalid unevaluated property "{{ property }}"',errorUniqueItems:"Must have unique items."};function Z(n,e,t,s,r){const i=[],a=Et(t);return R(e)&&d(a)&&(e=e.replace(/[\uDCA9]/g,""),e.length<a&&i.push({messages:[E(b.errorMinLength,{minLength:a})],path:r,constrain:"minLength"})),i}function _(n,e,t,s,r){const i=[],a=$(t);if(d(a)){let o=!1;a.forEach(l=>{const c=new P({refParser:n.refParser,schema:l,data:e}),h=c.getErrors();c.destroy(),h.length===0&&(o=!0)}),o||i.push({messages:[b.errorAnyOf],path:r,constrain:"anyOf"})}return i}function W(n,e,t,s,r){const i=[],a=V(t);return d(a)&&!a.some(l=>JSON.stringify(e)===JSON.stringify(l))&&i.push({messages:[E(b.errorEnum,{enum:JSON.stringify(a)})],path:r,constrain:"enum"}),i}function X(n,e,t,s,r){const i=[],a=pt(t);return M(e)&&d(a)&&e>=a&&i.push({messages:[E(b.errorExclusiveMaximum,{exclusiveMaximum:a})],path:r,constrain:"exclusiveMaximum"}),i}function Q(n,e,t,s,r){const i=[],a=mt(t);return M(e)&&d(a)&&e<=a&&i.push({messages:[E(b.errorExclusiveMinimum,{exclusiveMinimum:a})],path:r,constrain:"exclusiveMinimum"}),i}function Y(n,e,t,s,r){const i=[],a=q(t);let o=n.validateFormat;if(m(t,"validateFormat")&&(o=t.options.validateFormat),d(a)&&R(e)&&o){let l;a==="email"&&(l=new RegExp(/^[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/i)),a==="url"&&(l=new RegExp(/^(?:https?|ftp):\/\/(?:[^\s:@]+(?::[^\s:@]*)?@)?(?:(?:[^\s:@]+(?::[^\s:@]*)?@)?(?:[^\s:@](?:[^\s:@-]*[^\s:@])?\.?)+[a-zA-Z]{2,}|(?:\d{1,3}\.){3}\d{1,3})(?::\d{2,5})?(?:\/[^\s]*)?$/i)),a==="uuid"&&(l=new RegExp(/^(?:urn:uuid:)?[0-9a-fA-F]{8}-(?:[0-9a-fA-F]{4}-){3}[0-9a-fA-F]{12}$/i)),d(l)&&!l.test(e)&&i.push({messages:[E(b.errorFormat,{format:a})],path:r,constrain:"format"})}return i}function ee(n,e,t,s,r){const i=[],a=$e(t),o=He(t);if(x(e)&&d(a)){const l=d(o)?o.length:0;a===!1&&e.length>0&&e.length>l&&i.push({messages:[b.errorItems],path:r,constrain:"items"})}return i}function te(n,e,t,s,r){const i=[],a=ze(t);return x(e)&&d(a)&&e.length>a&&i.push({messages:[E(b.errorMaxItems,{maxItems:a})],path:r,constrain:"maxItems"}),i}function se(n,e,t,s,r){const i=[],a=bt(t);return R(e)&&d(a)&&(e=e.replace(/[\uDCA9]/g,""),e.length>a&&i.push({messages:[E(b.errorMaxLength,{maxLength:a})],path:r,constrain:"maxLength"})),i}function ie(n,e,t,s,r){const i=[],a=vt(t);return f(e)&&d(a)&&Object.keys(e).length>a&&i.push({messages:[E(b.errorMaxProperties,{maxProperties:a})],path:r,constrain:"maxProperties"}),i}function ne(n,e,t,s,r){const i=[],a=Ct(t);return M(e)&&d(a)&&e<a&&i.push({messages:[E(b.errorMinimum,{minimum:a})],path:r,constrain:"minimum"}),i}function re(n,e,t,s,r){const i=[],a=Je(t);return x(e)&&d(a)&&e.length<a&&i.push({messages:[E(b.errorMinItems,{minItems:a})],path:r,constrain:"minItems"}),i}function ae(n,e,t,s,r){const i=[],a=Lt(t);return f(e)&&d(a)&&Object.keys(e).length<a&&i.push({messages:[E(b.errorMinProperties,{minProperties:a})],path:r,constrain:"minProperties"}),i}function oe(n,e,t,s,r){const i=[],a=xt(t);if(M(e)&&d(a)){if(e===0)return i;(!(e/a===Math.floor(e/a))||e.toString().includes("e"))&&i.push({messages:[E(b.errorMultipleOf,{multipleOf:a})],path:r,constrain:"multipleOf"})}return i}function le(n,e,t,s,r){const i=[],a=It(t);if(d(a)){const o=new P({refParser:n.refParser,schema:a,data:e}),l=o.getErrors();o.destroy(),l.length===0&&i.push({messages:[E(b.errorNot)],path:r,constrain:"not"})}return i}function ce(n,e,t,s,r){const i=[],a=J(t);if(d(a)){let o=0;a.forEach(l=>{const c=new P({refParser:n.refParser,schema:l,data:e}),h=c.getErrors();c.destroy(),h.length===0&&o++}),o!==1&&i.push({messages:[E(b.errorOneOf,{counter:o})],path:r,constrain:"oneOf"})}return i}function de(n,e,t,s,r){const i=[],a=wt(t);return R(e)&&d(a)&&!new RegExp(a).test(e)&&i.push({messages:[E(b.errorPattern,{pattern:a})],path:r,constrain:"pattern"}),i}function he(n,e,t,s){let r=[];const i=be(t);return f(e)&&d(i)&&Object.keys(e).forEach(a=>{Object.keys(i).forEach(o=>{if(new RegExp(o).test(a)){const c=i[o],h=new P({refParser:n.refParser,schema:c,data:e[a]}),u=h.getErrors().map(p=>({messages:p.messages,path:s+"/"+a,constrain:"patternProperties"}));r=[...r,...u],h.destroy()}})}),r}function ue(n,e,t,s,r){const i=[],a=_e(t);if(f(e)&&d(a)){const o=[],l=Object.keys(e);a.forEach(h=>{l.includes(h)||o.push(h)}),o.length>0&&i.push({messages:[E(b.errorRequired,{required:o.join(", ")})],path:r,constrain:"required"})}return i}function pe(n,e,t,s,r){const i=[],a=H(t);if(a==="any")return i;if(d(a)){const o={string:c=>R(c),number:c=>M(c),integer:c=>B(c),boolean:c=>T(c),array:c=>x(c),object:c=>f(c),null:c=>je(c)};let l=!0;x(a)?l=a.some(c=>o[c](e)):l=o[a](e),l||i.push({messages:[E(b.errorType,{type:a,valueType:nt(e)})],path:r,constrain:"type"})}return i}function me(n,e,t,s,r){const i=[],a=ft(t);return M(e)&&d(a)&&e>a&&i.push({messages:[E(b.errorMaximum,{maximum:a})],path:r,constrain:"maximum"}),i}function fe(n,e,t,s,r){const i=[],a=Pt(t);if(x(e)&&d(a)&&a===!0){const o=[];let l=!1;for(let h=0;h<e.length;h++){let u=e[h];f(u)&&(u=Se(u));const p=JSON.stringify(u);if(l=o.some(g=>g===p),l)break;o.push(p)}l&&i.push({messages:[b.errorUniqueItems],path:r,constrain:"uniqueItems"})}return i}function ge(n,e,t,s,r){const i=[],a=ke(t),o=be(t),l=ve(t);if(f(e)&&d(a)){const c=l||{},h=a,u=o||{};Object.keys(e).forEach(p=>{const g=Object.keys(u).some(v=>new RegExp(v).test(p)),C=N(c,p);if(!g&&!C){if(h===!1)i.push({messages:[E(b.errorAdditionalProperties,{property:p})],path:r,constrain:"additionalProperties"});else if(f(h)){const v=new P({refParser:n.refParser,schema:h,data:e[p]}),L=v.getErrors().map(y=>({messages:y.messages,path:`${r}.${p}`,constrain:"additionalProperties"}));i.push(...L),v.destroy()}}})}return i}const St={additionalProperties:ge,allOf:G,anyOf:_,enum:W,exclusiveMaximum:X,exclusiveMinimum:Q,format:Y,items:ee,maximum:me,maxItems:te,maxLength:se,maxProperties:ie,minimum:ne,minItems:re,minLength:Z,minProperties:ae,multipleOf:oe,not:le,oneOf:ce,pattern:de,patternProperties:he,required:ue,type:pe,uniqueItems:fe};function Ce(n,e,t,s,r){const i=[],a=ct(t);return d(a)&&Te(e,a)&&i.push({messages:[E(b.errorConst,{const:JSON.stringify(a)})],path:r,constrain:"const"}),i}function ye(n,e,t,s,r){const i=[],a=dt(t),o=yt(t),l=gt(t);if(x(e)&&d(a)){let c=0;e.forEach(u=>{const p=new P({refParser:n.refParser,schema:a,data:u});p.getErrors().length===0&&c++,p.destroy()});const h=c===0;d(o)?c<o&&i.push({messages:[E(b.errorMinContains,{counter:c,minContains:o})],path:r,constrain:"minContains"}):h&&i.push({messages:[b.errorContains],path:r,constrain:"contains"}),d(l)&&c>l&&i.push({messages:[E(b.errorMaxContains,{counter:c,maxContains:l})],path:r,constrain:"maxContains"})}return i}function Ee(n,e,t,s,r){const i=[],a=Ke(t);if(f(e)&&d(a)){let o=[];Object.keys(a).forEach(c=>{d(e[c])&&(o=a[c].filter(u=>!N(e,u)))}),o.length>0&&i.push({messages:[E(b.errorDependentRequired,{dependentRequired:o.join(", ")})],path:r,constrain:"dependentRequired"})}return i}function Le(n,e,t){let s=[];const r=ut(t);return f(e)&&d(r)&&Object.keys(r).forEach(i=>{if(d(e[i])){const a=r[i],o=new P({refParser:n.refParser,schema:a,data:e}),l=o.getErrors();o.destroy(),s=[...s,...l]}}),s}function xe(n,e,t){const s=[],r=Re(t),i=Be(t),a=Ve(t);if(d(r)){if(D(i)&&D(a))return s;const o=new P({refParser:n.refParser,schema:r,data:e}),l=o.getErrors();o.destroy();let c=[],h=[];if(d(i)){const u=new P({refParser:n.refParser,schema:i,data:e});c=u.getErrors(),u.destroy()}if(d(a)){const u=new P({refParser:n.refParser,schema:a,data:e});h=u.getErrors(),u.destroy()}if(r===!0)return c;if(r===!1)return h;if(l.length===0)return c;if(l.length>0)return h}return s}function Ie(n,e,t,s,r){const i=[],a=He(t);return x(e)&&d(a)&&a.forEach((o,l)=>{const c=e[l];if(d(c)){const h=new P({refParser:n.refParser,schema:o,data:c}),u=h.getErrors();h.destroy(),u.length>0&&i.push({messages:[E(b.errorPrefixItems,{index:l})],path:r,constrain:"prefixItems"})}}),i}const Ot={additionalProperties:ge,allOf:G,anyOf:_,const:Ce,contains:ye,dependentRequired:Ee,dependentSchemas:Le,enum:W,exclusiveMaximum:X,exclusiveMinimum:Q,format:Y,if:xe,items:ee,maximum:me,maxItems:te,maxLength:se,maxProperties:ie,minimum:ne,minItems:re,minLength:Z,minProperties:ae,multipleOf:oe,not:le,oneOf:ce,pattern:de,patternProperties:he,prefixItems:Ie,required:ue,type:pe,uniqueItems:fe},Tt={additionalProperties:ge,allOf:G,anyOf:_,const:Ce,contains:ye,dependentRequired:Ee,dependentSchemas:Le,enum:W,exclusiveMaximum:X,exclusiveMinimum:Q,format:Y,if:xe,items:ee,maximum:me,maxItems:te,maxLength:se,maxProperties:ie,minimum:ne,minItems:re,minLength:Z,minProperties:ae,multipleOf:oe,not:le,oneOf:ce,pattern:de,patternProperties:he,prefixItems:Ie,required:ue,type:pe,uniqueItems:fe};function We(n,e,t,s,r){let i=[];const a=At(t),o=be(t),l=ve(t),c=Me(t),h=$(t),u=J(t);if(f(e)&&d(a)){let p=d(l)?l:{};const g=a,C=o;[c,h,u].forEach(L=>{d(L)&&L.forEach(y=>{d(y.properties)&&(p={...p,...y.properties})})}),p&&Object.keys(e).forEach(L=>{let y=!1;if(d(C)&&Object.keys(C).forEach(S=>{y=new RegExp(S).test(L)}),!y&&g===!1&&!N(p,L)&&i.push({messages:[E(b.errorUnevaluatedProperties,{property:L})],path:r,constrain:"unevaluatedProperties"}),!y&&f(g)&&!N(p,L)){const S=new P({refParser:n.refParser,schema:g,data:e[L]}),w=S.getErrors().map(k=>({messages:k.messages,path:L,constrain:"unevaluatedProperties"}));i=[...i,...w],S.destroy()}})}return i}const jt={additionalProperties:ge,allOf:G,anyOf:_,const:Ce,contains:ye,dependentRequired:Ee,dependentSchemas:Le,enum:W,exclusiveMaximum:X,exclusiveMinimum:Q,format:Y,if:xe,items:ee,maximum:me,maxItems:te,maxLength:se,maxProperties:ie,minimum:ne,minItems:re,minLength:Z,minProperties:ae,multipleOf:oe,not:le,oneOf:ce,pattern:de,patternProperties:he,prefixItems:Ie,required:ue,type:pe,unevaluatedProperties:We,uniqueItems:fe};function kt(n,e,t,s,r){const i=[],a=lt(t);return f(e)&&d(a)&&Object.keys(e).forEach(o=>{new P({refParser:n.refParser,schema:a,data:o}).getErrors().length>0&&i.push({messages:[E(b.errorPropertyNames,{propertyName:o})],path:r,constrain:"propertyNames"})}),i}const Xe={additionalProperties:ge,allOf:G,anyOf:_,const:Ce,contains:ye,dependentRequired:Ee,dependentSchemas:Le,enum:W,exclusiveMaximum:X,exclusiveMinimum:Q,format:Y,if:xe,items:ee,maximum:me,maxItems:te,maxLength:se,maxProperties:ie,minimum:ne,minItems:re,minLength:Z,minProperties:ae,multipleOf:oe,not:le,oneOf:ce,pattern:de,patternProperties:he,prefixItems:Ie,propertyNames:kt,required:ue,type:pe,unevaluatedProperties:We,uniqueItems:fe};let Mt=class{constructor(e={}){this.refParser=e.refParser,this.validateFormat=e.validateFormat?e.validateFormat:!1,this.draft=Xe,this.jsonSchemaDrafts={"http://json-schema.org/draft-04/schema#":St,"http://json-schema.org/draft-06/schema#":Ot,"http://json-schema.org/draft-07/schema#":Tt,"https://json-schema.org/draft/2019-09/schema":jt,"https://json-schema.org/draft/2020-12/schema":Xe}}getErrors(e,t,s,r){let i=[];const a=m(t,"messages"),o=O(t);return T(o)&&o===!0?i:T(o)&&o===!1?[{messages:d(a)?a:["invalid"],path:r}]:(Object.keys(this.draft).forEach(l=>{if(N(o,l)){const c=this.draft[l],h=c(this,e,t,s,r);h&&(i=[...i,...h])}}),i.length>0&&a&&(i=[{messages:a,path:r}]),i)}};class Qe{constructor(){this.listeners=[]}on(e,t){this.listeners.push({name:e,callback:t})}off(e){this.listeners=this.listeners.filter(t=>t.name!==e)}emit(e,t=void 0){this.listeners.filter(r=>r.name===e).forEach(r=>{r.callback(t)})}destroy(){Object.keys(this).forEach(e=>{delete this[e]})}}class F extends Qe{constructor(e){super(),this.jedi=e.jedi,this.path=e.path||this.jedi.rootName,this.schema=e.schema,this.value=d(e.value)?e.value:void 0,this.isActive=!0,this.parent=e.parent||null,this.children=[],this.ui=null,this.init()}init(){this.register(),this.setInitialValue(),this.prepare(),this.setDefaultValue(),this.jedi.options.container&&this.setUI(),this.on("change",()=>{this.parent&&this.parent.onChildChange()})}setUI(){}getKey(){return this.path.split(this.jedi.pathSeparator).pop()}register(){this.jedi.register(this)}unregister(){this.jedi.unregister(this)}setInitialValue(){if(D(this.value)){let e;const t=H(this.schema);t==="boolean"&&(e=!1),t==="number"&&(e=0),t==="integer"&&(e=0),t==="string"&&(e=""),t==="array"&&(e=[]),t==="object"&&(e={}),t==="null"&&(e=null),this.value=e}}setDefaultValue(){const e=ht(this.schema);d(e)&&this.setValue(e,!1)}getValue(){return this.value}setValue(e,t=!0){this.value=e,this.emit("set-value",e),t&&this.emit("change")}onChildChange(){}getErrors(){if(!this.isActive)return[];const e=this.jedi.validator.getErrors(this.getValue(),this.schema,this.getKey(),this.path);return Ue(e)}prepare(){}activate(){this.isActive===!1&&(this.isActive=!0,this.emit("change"))}deactivate(){this.isActive===!0&&(this.isActive=!1,this.emit("change"))}isReadOnly(){let e=!1;return Ze(this.schema)===!0&&(e=!0),this.parent&&Ze(this.parent.schema)===!0&&(e=!0),e}destroy(){this.listeners=[],this.children.forEach(e=>{e.destroy()}),this.unregister(),this.ui&&this.ui.destroy(),Object.keys(this).forEach(e=>{delete this[e]}),super.destroy()}}const Vt={properties:"glyphicon glyphicon-list",delete:"glyphicon glyphicon-trash",add:"glyphicon glyphicon-plus",moveUp:"glyphicon glyphicon-arrow-up",moveDown:"glyphicon glyphicon-arrow-down",collapse:"glyphicon glyphicon-chevron-down"},Rt={properties:"bi bi-card-list",delete:"bi bi-trash2",add:"bi bi-plus",moveUp:"bi bi-arrow-up",moveDown:"bi bi-arrow-down",collapse:"bi bi-chevron-down"},Ht={properties:"icon-list",delete:"icon-trash",add:"icon-plus",moveUp:"icon-arrow-up",moveDown:"icon-arrow-down",collapse:"icon-chevron-down"},Bt={properties:"fa fa-list",delete:"fa fa-trash-o",add:"fa fa-plus",moveUp:"fa fa-arrow-up",moveDown:"fa fa-arrow-down",collapse:"fa fa-chevron-down"},qt={properties:"fas fa-list",delete:"fas fa-trash",add:"fas fa-plus",moveUp:"fas fa-arrow-up",moveDown:"fas fa-arrow-down",collapse:"fas fa-chevron-down"},Nt={properties:"fa-solid fa-list",delete:"fa-solid fa-trash",add:"fa-solid fa-plus",moveUp:"fa-solid fa-arrow-up",moveDown:"fa-solid fa-arrow-down",collapse:"fa-solid fa-chevron-down"};class we{constructor(e=null){this.icons=e,this.useToggleEvents=!0,this.init()}init(){this.useToggleEvents=!0}getIcon(e){const t=document.createElement("i"),s=this.icons[e].split(" ");return s.length>0&&s.forEach(r=>{t.classList.add(r)}),t}getEditorContainer(){const e=document.createElement("div");return e.classList.add("jedi-editor-container"),e}getFieldset(){const e=document.createElement("fieldset");return e.classList.add("jedi-editor-fieldset"),e}getLegend(e){const t=document.createElement("legend"),s=document.createElement("span");return t.classList.add("jedi-editor-legend"),s.classList.add("jedi-editor-legend-text"),t.setAttribute("aria-labelledby","#legend-"+e.id),s.textContent=e.textContent,s.setAttribute("id","#legend-"+e.id),t.appendChild(s),t}getCard(){const e=document.createElement("div");return e.classList.add("jedi-editor-card"),e}getCardHeader(){const e=document.createElement("div");return e.classList.add("jedi-editor-card-header"),e}getCardBody(){const e=document.createElement("div");return e.classList.add("jedi-editor-card-body"),e}getActionsSlot(){const e=document.createElement("div");return e.classList.add("jedi-actions-slot"),e}getArrayActionsSlot(){const e=document.createElement("span");return e.classList.add("jedi-array-actions-slot"),e}getChildrenSlot(){const e=document.createElement("div");return e.classList.add("jedi-children-slot"),e}getMessagesSlot(e={}){const t=document.createElement("div");return t.classList.add("jedi-messages-slot"),t.setAttribute("aria-atomic","false"),t.setAttribute("aria-live","polite"),e.id&&t.setAttribute("id",e.id),t}getControlSlot(){const e=document.createElement("div");return e.classList.add("jedi-control-slot"),e}getPropertiesToggle(e){const t=this.getButton(e);return t.classList.add("jedi-properties-toggle"),t.addEventListener("click",()=>{e.propertiesContainer.open?e.propertiesContainer.close():e.propertiesContainer.showModal()}),t}getCollapse(e){const t=document.createElement("div");return t.classList.add("jedi-collapse"),t.setAttribute("id",e.id),this.useToggleEvents&&e.startCollapsed&&(t.style.display="none"),t}getCollapseToggle(e){const t=this.getButton(e);t.classList.add("jedi-collapse-toggle"),this.useToggleEvents&&t.addEventListener("click",()=>{e.collapse.style.display==="none"?e.collapse.style.display="block":e.collapse.style.display="none"});let s=e.startCollapsed;return t.style.transition="transform 0.1s ease",s&&(t.style.transform="rotate(90deg)"),t.addEventListener("click",()=>{s?t.style.transform="rotate(0deg)":t.style.transform="rotate(90deg)",s=!s}),t}getPropertiesSlot(e){const t=document.createElement("dialog");return t.classList.add("jedi-properties-slot"),t.setAttribute("id",e.id),window.addEventListener("click",s=>{s.target===t&&t.close()}),t}getPropertiesAriaLive(){const e=document.createElement("div");return e.classList.add("jedi-properties-aria-live"),e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e}getAriaLiveMessage(e){const t=document.createElement("p");return t.classList.add("jedi-aria-live-message"),t.textContent=e,this.visuallyHidden(t),t}getPropertiesActivators(){const e=document.createElement("div");return e.classList.add("jedi-properties-activators"),e}getBtnGroup(){const e=document.createElement("span");return e.classList.add("jedi-btn-group"),e}getButton(e){const t=document.createElement("button");t.classList.add("jedi-btn"),t.setAttribute("type","button"),e.value&&(t.value=e.value),e.id&&t.setAttribute("id",e.id);const s=document.createElement("span");if(s.textContent=e.textContent,this.icons&&e.icon){const r=this.getIcon(e.icon);r.setAttribute("title",e.textContent),t.appendChild(r),this.visuallyHidden(s)}return t.appendChild(s),t}getArrayBtnAdd(){const e=this.getButton({textContent:"Add item",icon:"add"});return e.classList.add("jedi-array-add"),e}getAddPropertyButton(){const e=this.getButton({textContent:"Add property"});return e.classList.add("jedi-add-property-btn"),e}getDeleteItemBtn(){const e=this.getButton({textContent:"Delete item",icon:"delete"});return e.classList.add("jedi-array-delete"),e}getMoveUpItemBtn(){const e=this.getButton({textContent:"Move up",icon:"moveUp"});return e.classList.add("jedi-array-move-up"),e}getMoveDownItemBtn(){const e=this.getButton({textContent:"Move down",icon:"moveDown"});return e.classList.add("jedi-array-move-down"),e}getDescription(e={}){const t=document.createElement("small");return t.classList.add("jedi-description"),e.textContent&&(t.textContent=e.textContent),e.id&&t.setAttribute("id",e.id),t}getObjectControl(e){const t=document.createElement("div"),s=this.getActionsSlot(),r=this.getArrayActionsSlot(),i=this.getCardBody(),a=this.getPropertiesAriaLive(),o=this.getDescription({textContent:e.description}),l=this.getMessagesSlot(),c=this.getChildrenSlot(),h=this.getPropertiesSlot({id:"properties-slot-"+e.id}),u=this.getPropertiesToggle({textContent:e.title+" properties",id:"properties-slot-toggle-"+e.id,icon:"properties",propertiesContainer:h}),p="collapse-"+e.id,g=this.getCollapse({id:p,startCollapsed:e.startCollapsed}),C=this.getCollapseToggle({textContent:e.title+" properties",id:"collapse-toggle-"+e.id,icon:"collapse",collapseId:p,collapse:g,startCollapsed:e.startCollapsed}),v=this.getPropertiesActivators(),L=this.getInputControl({type:"text",id:"jedi-add-property-input-"+e.id,label:"Property"}),y=this.getAddPropertyButton(),S=this.getFieldset(),w=this.getLegend({textContent:e.title,id:e.id});return y.classList.add("jedi-object-add"),t.appendChild(S),t.appendChild(h),S.appendChild(w),S.appendChild(g),g.appendChild(i),i.appendChild(o),i.appendChild(l),w.appendChild(s),s.appendChild(r),i.appendChild(c),e.addProperty&&(h.appendChild(L.container),h.appendChild(y),h.appendChild(document.createElement("hr"))),e.enablePropertiesToggle&&(s.appendChild(u),h.appendChild(a),h.appendChild(v)),e.enableCollapseToggle&&s.appendChild(C),{container:t,collapse:g,collapseToggle:C,body:i,actions:s,messages:l,childrenSlot:c,propertiesToggle:u,propertiesContainer:h,addPropertyControl:L,addPropertyBtn:y,ariaLive:a,propertiesActivators:v,arrayActions:r}}getArrayControl(e){const t=document.createElement("div"),s=this.getActionsSlot(),r=this.getArrayActionsSlot(),i=this.getCardBody(),a=this.getDescription({textContent:e.description}),o=this.getMessagesSlot(),l=this.getChildrenSlot(),c=this.getBtnGroup(),h=this.getArrayBtnAdd(),u=this.getFieldset(),p=this.getLegend({textContent:e.title,id:e.id}),g="collapse-"+e.id,C=this.getCollapse({id:g,startCollapsed:e.startCollapsed}),v=this.getCollapseToggle({textContent:e.title+" properties",id:"collapse-toggle-"+e.id,icon:"collapse",collapseId:g,collapse:C,startCollapsed:e.startCollapsed});return t.appendChild(u),u.appendChild(p),u.appendChild(C),C.appendChild(i),i.appendChild(a),i.appendChild(o),p.appendChild(s),s.appendChild(c),c.appendChild(h),s.appendChild(r),i.appendChild(l),e.enableCollapseToggle&&s.appendChild(v),{container:t,collapseToggle:v,collapse:C,body:i,actions:s,messages:o,childrenSlot:l,btnGroup:c,addBtn:h,arrayActions:r}}getMultipleControl(e){const t=document.createElement("div"),s=this.getCard(),r=this.getActionsSlot(),i=this.getArrayActionsSlot(),a=this.getCardHeader({textContent:e.title,titleHidden:e.titleHidden}),o=this.getCardBody(),l=this.getDescription({textContent:e.description}),c=this.getMessagesSlot(),h=this.getChildrenSlot(),u=this.getSwitcher({values:e.switcherOptionValues,titles:e.switcherOptionsLabels,id:e.id+"-switcher",label:e.id+"-switcher",titleHidden:!0,readOnly:e.readOnly});return u.container.classList.add("jedi-switcher"),t.appendChild(l),t.appendChild(s),s.appendChild(a),s.appendChild(o),a.appendChild(r),r.appendChild(u.container),r.appendChild(i),o.appendChild(c),o.appendChild(h),{container:t,card:s,header:a,body:o,actions:r,messages:c,childrenSlot:h,switcher:u,arrayActions:i}}getNullControl(e){const t=document.createElement("div"),s=this.getActionsSlot(),r=this.getArrayActionsSlot(),i=document.createElement("label");i.setAttribute("for",e.id);const a=document.createElement("span");a.textContent=e.label,e.titleHidden&&this.visuallyHidden(i);const o=e.id+"-description",l=this.getDescription({textContent:e.description,id:o}),c=this.getMessagesSlot();return t.appendChild(i),t.appendChild(l),t.appendChild(c),t.appendChild(s),s.appendChild(r),i.appendChild(a),{container:t,label:i,labelText:a,description:l,messages:c,actions:s,arrayActions:r}}getTextareaControl(e){const t=document.createElement("div"),s=this.getActionsSlot(),r=this.getArrayActionsSlot(),i=document.createElement("textarea");i.setAttribute("id",e.id),i.style.width="100%";const a=document.createElement("label");a.setAttribute("for",e.id);const o=document.createElement("span");o.textContent=e.label,e.titleHidden&&this.visuallyHidden(a);const l=e.id+"-description",c=this.getDescription({textContent:e.description,id:l}),h=e.id+"-messages",u=this.getMessagesSlot({id:h}),p=h+" "+l;return i.setAttribute("aria-describedby",p),t.appendChild(a),t.appendChild(i),t.appendChild(c),t.appendChild(u),t.appendChild(s),s.appendChild(r),a.appendChild(o),{container:t,input:i,label:a,labelText:o,description:c,messages:u,actions:s,arrayActions:r}}getInputControl(e){const t=document.createElement("div"),s=this.getActionsSlot(),r=this.getArrayActionsSlot(),i=document.createElement("input");i.setAttribute("type",e.type),i.setAttribute("id",e.id),i.style.width="100%";const a=document.createElement("label");a.setAttribute("for",e.id);const o=document.createElement("span");o.textContent=e.label,e.titleHidden&&this.visuallyHidden(a);const l=e.id+"-description",c=this.getDescription({textContent:e.description,id:l}),h=e.id+"-messages",u=this.getMessagesSlot({id:h}),p=h+" "+l;return i.setAttribute("aria-describedby",p),t.appendChild(a),t.appendChild(i),t.appendChild(c),t.appendChild(u),t.appendChild(s),s.appendChild(r),a.appendChild(o),{container:t,input:i,label:a,labelText:o,description:c,messages:u,actions:s,arrayActions:r}}getRadiosControl(e){const t=document.createElement("div"),s=this.getActionsSlot(),r=this.getArrayActionsSlot(),i=this.getFieldset(),a=this.getCardBody(),o=this.getLegend({textContent:e.label,id:e.id}),l=e.id+"-messages",c=this.getMessagesSlot({id:l}),h=e.id+"-description",u=this.getDescription({textContent:e.description,id:h});e.titleHidden&&this.visuallyHidden(o);const p=[],g=[],C=[],v=[];return e.values.forEach((L,y)=>{const S=document.createElement("div");p.push(S);const w=document.createElement("input");w.setAttribute("type","radio"),w.setAttribute("id",e.id+"-"+y),w.setAttribute("value",L),g.push(w);const k=l+" "+h;w.setAttribute("aria-describedby",k);const Pe=document.createElement("label");Pe.setAttribute("for",e.id+"-"+y);const st=document.createElement("span");v.push(st),e.titles&&e.titles[y]&&(st.textContent=e.titles[y]),C.push(Pe)}),t.appendChild(i),t.appendChild(s),i.appendChild(o),i.appendChild(a),s.appendChild(r),p.forEach((L,y)=>{a.appendChild(p[y]),L.appendChild(g[y]),L.appendChild(C[y]),C[y].appendChild(v[y])}),i.appendChild(u),i.appendChild(c),{container:t,fieldset:i,legend:o,body:a,radios:g,labels:C,labelTexts:v,radioControls:p,description:u,messages:c,actions:s,arrayActions:r}}getCheckboxControl(e){const t=document.createElement("div"),s=this.getActionsSlot(),r=this.getArrayActionsSlot(),i=document.createElement("div"),a=document.createElement("input");a.setAttribute("type","checkbox"),a.setAttribute("id",e.id);const o=document.createElement("label");o.setAttribute("for",e.id);const l=document.createElement("span");l.textContent=e.label,e.titleHidden&&this.visuallyHidden(o);const c=e.id+"-description",h=this.getDescription({textContent:e.description,id:c}),u=e.id+"-messages",p=this.getMessagesSlot({id:u}),g=u+" "+c;return a.setAttribute("aria-describedby",g),t.appendChild(i),t.appendChild(s),s.appendChild(r),i.appendChild(a),i.appendChild(o),o.appendChild(l),i.appendChild(h),i.appendChild(p),{container:t,formGroup:i,input:a,label:o,labelText:l,description:h,messages:p,actions:s,arrayActions:r}}getSelectControl(e){const t=document.createElement("div"),s=this.getActionsSlot(),r=this.getArrayActionsSlot(),i=document.createElement("select");i.setAttribute("id",e.id),e.values.forEach((g,C)=>{const v=document.createElement("option");v.setAttribute("value",g),e.titles&&e.titles[C]&&(v.textContent=e.titles[C]),i.appendChild(v)});const a=document.createElement("label");a.setAttribute("for",e.id);const o=document.createElement("span");o.textContent=e.label,e.titleHidden&&this.visuallyHidden(a);const l=e.id+"-description",c=this.getDescription({textContent:e.description,id:l}),h=e.id+"-messages",u=this.getMessagesSlot({id:h}),p=h+" "+l;return i.setAttribute("aria-describedby",p),t.appendChild(a),t.appendChild(i),a.appendChild(o),t.appendChild(c),t.appendChild(u),t.appendChild(s),s.appendChild(r),{container:t,input:i,label:a,labelText:o,description:c,messages:u,actions:s,arrayActions:r}}getSwitcher(e){const t=document.createElement("span"),s=document.createElement("select");s.setAttribute("id",e.id),e.values.forEach((a,o)=>{const l=document.createElement("option");l.setAttribute("value",a),e.titles&&e.titles[o]&&(l.textContent=e.titles[o]),s.appendChild(l)});const r=document.createElement("label");r.setAttribute("for",e.id);const i=document.createElement("span");return i.textContent=e.label,this.visuallyHidden(r),t.appendChild(r),t.appendChild(s),r.appendChild(i),{container:t,input:s,label:r,labelText:i}}getAlert(e){return this.getInvalidFeedback(e)}getInvalidFeedback(e){const t=document.createElement("div"),s=document.createElement("span"),r=document.createElement("span");return s.textContent=e.message,r.textContent="âš  ",r.classList.add("jedi-error-message"),r.setAttribute("aria-hidden","true"),t.classList.add("jedi-error-message"),t.appendChild(r),t.appendChild(s),t}getRow(){const e=document.createElement("div");return e.classList.add("jedi-row"),e}getCol(e,t,s){const r=document.createElement("div");return r.classList.add("jedi-col-xs-"+e),r.classList.add("jedi-col-md-"+t),s&&r.classList.add("jedi-col-md-offset-"+s),r}getTabList(){const e=document.createElement("ul");return e.classList.add("jedi-nav-list"),e}getTab(e){const t=document.createElement("li"),s=document.createElement("a");return s.classList.add("jedi-nav-link"),s.setAttribute("href","#"+e.id),s.textContent=e.title,t.appendChild(s),{list:t,link:s}}getTabContent(){const e=document.createElement("div");return e.classList.add("tab-content"),e}setTabPaneAttributes(e,t,s){e.setAttribute("id",s),e.classList.add("jedi-tab-pane")}visuallyHidden(e){e.setAttribute("style","position: absolute;width: 1px;height: 1px;padding: 0;margin: -1px;overflow: hidden;clip: rect(0,0,0,0);border: 0;")}visuallyVisible(e){e.removeAttribute("style")}}class Dt extends we{init(){this.useToggleEvents=!1}getAddPropertyButton(){const e=super.getAddPropertyButton();return e.classList.add("btn-primary"),e.classList.add("btn-block"),e}getCollapseToggle(e){const t=super.getCollapseToggle(e);return t.setAttribute("href","#"+e.collapseId),t.setAttribute("data-toggle","collapse"),t}getCollapse(e){const t=super.getCollapse(e);return t.classList.add("collapse"),e.startCollapsed||t.classList.add("in"),t}getFieldset(){const e=document.createElement("fieldset");return e.classList.add("panel"),e.classList.add("panel-default"),e}getLegend(e){const t=super.getLegend(e);return t.classList.add("h5"),t.classList.add("panel-heading"),t.classList.add("pull-left"),t.setAttribute("style","margin: 0; display: flex; justify-content: space-between; align-items: center;"),t}getCard(){const e=super.getCard();return e.classList.add("panel"),e.classList.add("panel-default"),e}getCardHeader(e){const t=super.getCardHeader(e);return t.classList.add("panel-heading"),t.classList.add("text-right"),t}getCardBody(){const e=super.getCardBody();return e.classList.add("panel-body"),e.style.clear="both",e}getBtnGroup(){const e=super.getBtnGroup();return e.classList.add("btn-group"),e}getButton(e){const t=super.getButton(e);return t.classList.add("btn"),t.classList.add("btn-xs"),t.classList.add("btn-default"),t}getDescription(e){const t=super.getDescription(e);return t.classList.add("text-muted"),t}getTextareaControl(e){const t=super.getTextareaControl(e),{container:s,input:r,label:i}=t;return s.classList.add("form-group"),r.classList.add("form-control"),e.titleHidden&&this.visuallyHidden(i),t}getInputControl(e){const t=super.getInputControl(e),{container:s,input:r,label:i}=t;return s.classList.add("form-group"),r.classList.add("form-control"),e.titleHidden&&this.visuallyHidden(i),t}getRadiosControl(e){const t=super.getRadiosControl(e),{body:s,radios:r,labels:i,labelTexts:a,radioControls:o,description:l,messages:c}=t;return o.forEach((h,u)=>{h.classList.add("radio"),s.appendChild(o[u]),h.appendChild(i[u]),i[u].appendChild(r[u]),i[u].appendChild(a[u])}),s.appendChild(l),s.appendChild(c),t}getCheckboxControl(e){const t=super.getCheckboxControl(e),{container:s,formGroup:r,input:i,label:a,labelText:o,description:l,messages:c}=t;return r.classList.add("checkbox"),s.appendChild(r),r.appendChild(a),a.appendChild(i),a.appendChild(o),r.appendChild(l),r.appendChild(c),t}getSelectControl(e){const t=super.getSelectControl(e),{container:s,input:r,label:i}=t;return s.classList.add("form-group"),r.classList.add("form-control"),e.titleHidden&&this.visuallyHidden(i),t}getAlert(e){const t=super.getAlert(e);return t.classList.add("alert"),t.classList.add("alert-danger"),t}getInvalidFeedback(e){const t=super.getInvalidFeedback(e);return t.classList.add("text-danger"),t}getRow(){const e=super.getRow();return e.classList.add("row"),e}getCol(e,t,s){const r=super.getRow();return r.classList.add("col-xs-"+e),r.classList.add("col-md-"+t),s&&r.classList.add("col-md-offset-"+s),r}getTabList(e){const t=super.getTabList(e);return t.classList.add("nav"),e.type==="tabs"?t.classList.add("nav-tabs"):t.classList.add("nav-pills"),t.classList.add("nav-stacked"),e.stacked===!1&&t.classList.remove("nav-stacked"),t}getTab(e){const t=super.getTab(e);return e.active&&t.list.classList.add("active"),t.link.setAttribute("data-toggle","tab"),t}setTabPaneAttributes(e,t,s){super.setTabPaneAttributes(e,t,s),e.classList.add("tab-pane"),t&&(e.classList.add("in"),e.classList.add("active"))}visuallyHidden(e){e.classList.add("sr-only")}visuallyVisible(e){e.classList.remove("sr-only")}}class Ft extends we{init(){this.useToggleEvents=!1}getAddPropertyButton(){const e=super.getAddPropertyButton();return e.classList.add("btn-primary"),e.classList.add("btn-block"),e}getCollapseToggle(e){const t=super.getCollapseToggle(e);return t.setAttribute("href","#"+e.collapseId),t.setAttribute("data-toggle","collapse"),t}getCollapse(e){const t=super.getCollapse(e);return t.classList.add("collapse"),e.startCollapsed||t.classList.add("show"),t}getFieldset(){const e=document.createElement("fieldset");return e.classList.add("card"),e.classList.add("mb-3"),e}getLegend(e){const t=super.getLegend(e);return t.classList.add("h6"),t.classList.add("card-header"),t.classList.add("d-flex"),t.classList.add("justify-content-between"),t.classList.add("align-items-center"),t.classList.add("float-left"),t.classList.add("py-2"),t}getCard(){const e=super.getCard();return e.classList.add("card"),e.classList.add("mb-3"),e}getCardHeader(e){const t=super.getCardHeader(e);return t.classList.add("card-header"),t.classList.add("d-flex"),t.classList.add("justify-content-end"),t.classList.add("align-items-center"),t.classList.add("py-1"),t}getCardBody(){const e=super.getCardBody();return e.classList.add("card-body"),e.classList.add("pb-0"),e}getBtnGroup(){const e=super.getBtnGroup();return e.classList.add("btn-group"),e}getButton(e){const t=super.getButton(e);return t.classList.add("btn"),t.classList.add("btn-sm"),t}getDescription(e){const t=super.getDescription(e);return t.classList.add("text-muted"),t}getTextareaControl(e){const t=super.getTextareaControl(e),{container:s,input:r,label:i}=t;return s.classList.add("form-group"),r.classList.add("form-control"),e.titleHidden&&this.visuallyHidden(i),t}getInputControl(e){const t=super.getInputControl(e),{container:s,input:r,label:i}=t;return s.classList.add("form-group"),r.classList.add("form-control"),e.titleHidden&&this.visuallyHidden(i),t}getRadiosControl(e){const t=super.getRadiosControl(e),{container:s,body:r,radios:i,labels:a,labelTexts:o,radioControls:l,description:c,messages:h}=t;return s.classList.add("form-group"),l.forEach((u,p)=>{u.classList.add("form-check"),i[p].classList.add("form-check-input"),a[p].classList.add("form-check-label"),r.appendChild(l[p]),u.appendChild(i[p]),u.appendChild(a[p]),a[p].appendChild(o[p])}),r.appendChild(c),r.appendChild(h),t}getCheckboxControl(e){const t=super.getCheckboxControl(e),{container:s,formGroup:r,input:i,label:a,description:o,messages:l}=t;return r.classList.add("form-group"),r.classList.add("form-check"),i.classList.add("form-check-input"),a.classList.add("form-check-label"),s.appendChild(r),r.appendChild(i),r.appendChild(a),r.appendChild(o),r.appendChild(l),t}getSelectControl(e){const t=super.getSelectControl(e),{container:s,input:r}=t;return s.classList.add("form-group"),r.classList.add("form-control"),t}getAlert(e){const t=super.getAlert(e);return t.classList.add("alert"),t.classList.add("alert-danger"),t}getInvalidFeedback(e){const t=super.getInvalidFeedback(e);return t.classList.add("text-danger"),t.classList.add("form-text"),t.classList.add("d-block"),t}getColumnClass(e,t){return"col-"+e+"-"+t}getRow(){const e=super.getRow();return e.classList.add("row"),e}getCol(e,t,s){const r=super.getRow(e,t,s);return r.classList.add("col-"+e),r.classList.add("col-md-"+t),s&&r.classList.add("offset-md-"+s),r}getTabList(e){const t=super.getTabList();return t.classList.add("nav"),e.type==="tabs"?t.classList.add("nav-tabs"):t.classList.add("nav-pills"),t.classList.add("flex-column"),e.stacked===!1&&t.classList.remove("flex-column"),t}getTab(e){const t=super.getTab(e);return t.list.classList.add("nav-item"),t.link.classList.add("nav-link"),t.link.setAttribute("data-toggle","tab"),e.active&&t.link.classList.add("active"),t}setTabPaneAttributes(e,t,s){super.setTabPaneAttributes(e,t,s),e.classList.add("tab-pane"),t&&e.classList.add("active")}visuallyHidden(e){e.classList.add("sr-only")}visuallyVisible(e){e.classList.remove("sr-only")}}class Ut extends we{init(){this.useToggleEvents=!1}getAddPropertyButton(){const e=super.getAddPropertyButton();return e.classList.add("btn-primary"),e.classList.add("w-100"),e}getCollapseToggle(e){const t=super.getCollapseToggle(e);return t.setAttribute("href","#"+e.collapseId),t.setAttribute("data-bs-toggle","collapse"),t}getCollapse(e){const t=super.getCollapse(e);return t.classList.add("collapse"),e.startCollapsed||t.classList.add("show"),t}getFieldset(){const e=document.createElement("fieldset");return e.classList.add("card"),e.classList.add("mb-3"),e}getLegend(e){const t=super.getLegend(e);return t.classList.add("h6"),t.classList.add("card-header"),t.classList.add("d-flex"),t.classList.add("justify-content-between"),t.classList.add("align-items-center"),t.classList.add("py-2"),t}getCard(){const e=super.getCard();return e.classList.add("card"),e.classList.add("mb-3"),e}getCardHeader(e){const t=super.getCardHeader(e);return t.classList.add("card-header"),t.classList.add("d-flex"),t.classList.add("justify-content-end"),t.classList.add("align-items-center"),t.classList.add("py-1"),t}getCardBody(){const e=super.getCardBody();return e.classList.add("card-body"),e.classList.add("pb-0"),e}getControlSlot(){const e=super.getControlSlot();return e.classList.add("mb-3"),e}getBtnGroup(){const e=super.getBtnGroup();return e.classList.add("btn-group"),e}getButton(e){const t=super.getButton(e);return t.classList.add("btn"),t.classList.add("btn-sm"),t}getDescription(e){const t=super.getDescription(e);return t.classList.add("text-muted"),t}getTextareaControl(e){const t=super.getTextareaControl(e),{container:s,input:r,label:i}=t;return s.classList.add("mb-3"),r.classList.add("form-control"),e.titleHidden&&this.visuallyHidden(i),t}getInputControl(e){const t=super.getInputControl(e),{container:s,input:r,label:i}=t;return s.classList.add("mb-3"),r.classList.add("form-control"),e.titleHidden&&this.visuallyHidden(i),t}getRadiosControl(e){const t=super.getRadiosControl(e),{container:s,body:r,radios:i,labels:a,labelTexts:o,radioControls:l,description:c,messages:h}=t;return s.classList.add("mb-3"),l.forEach((u,p)=>{u.classList.add("form-check"),i[p].classList.add("form-check-input"),a[p].classList.add("form-check-label"),r.appendChild(l[p]),u.appendChild(i[p]),u.appendChild(a[p]),a[p].appendChild(o[p])}),r.appendChild(c),r.appendChild(h),t}getCheckboxControl(e){const t=super.getCheckboxControl(e),{container:s,formGroup:r,input:i,label:a,description:o,messages:l}=t;return s.classList.add("mb-3"),r.classList.add("form-check"),i.classList.add("form-check-input"),a.classList.add("form-check-label"),e.titleHidden&&this.visuallyHidden(a),s.appendChild(r),r.appendChild(i),r.appendChild(a),r.appendChild(o),r.appendChild(l),t}getSelectControl(e){const t=super.getSelectControl(e),{container:s,input:r}=t;return s.classList.add("mb-3"),r.classList.add("form-select"),t}getAlert(e){const t=super.getAlert(e);return t.classList.add("alert"),t.classList.add("alert-danger"),t}getInvalidFeedback(e){const t=super.getInvalidFeedback(e);return t.classList.add("text-danger"),t.classList.add("d-block"),t.classList.add("form-text"),t.classList.add("form-text"),t}getRow(){const e=super.getRow();return e.classList.add("row"),e}getCol(e,t,s){const r=super.getRow(e,t,s);return r.classList.add("col-"+e),r.classList.add("col-md-"+t),s&&r.classList.add("offset-md-"+s),r}getTabList(e){const t=super.getTabList(e);return t.classList.add("nav"),e.type==="tabs"?t.classList.add("nav-tabs"):t.classList.add("nav-pills"),t.classList.add("flex-column"),e.stacked===!1&&t.classList.remove("flex-column"),t}getTab(e){const t=super.getTab(e);return t.list.classList.add("nav-item"),t.link.classList.add("nav-link"),t.link.setAttribute("data-bs-toggle","tab"),e.active&&t.link.classList.add("active"),t}setTabPaneAttributes(e,t,s){super.setTabPaneAttributes(e,t,s),e.classList.add("tab-pane"),t&&e.classList.add("active")}visuallyHidden(e){e.classList.add("visually-hidden")}visuallyVisible(e){e.classList.remove("visually-hidden")}}let U=class{constructor(e){if(this.instance=e,this.theme=null,this.control=null,this.disabled=!1,this.readOnly=this.instance.isReadOnly(),this.init(),this.build(),this.coerceValue(),this.addEventListeners(),this.setContainerAttributes(),this.refreshUI(),this.instance.jedi.options.showErrors==="always"||m(this.instance.schema,"showErrors")==="always"){const s=this.instance.getErrors();this.showValidationErrors(s)}this.instance.on("set-value",()=>{this.refreshUI();const s=this.instance.getErrors();this.showValidationErrors(s)}),this.instance.on("change",()=>{this.refreshUI();const s=this.instance.getErrors();this.showValidationErrors(s)})}init(){let e=null;if(d(this.instance.jedi.options.iconLib))switch(this.instance.jedi.options.iconLib){case"glyphicons":e=Vt;break;case"bootstrap-icons":e=Rt;break;case"fontawesome3":e=Ht;break;case"fontawesome4":e=Bt;break;case"fontawesome5":e=qt;break;case"fontawesome6":e=Nt;break}switch(this.instance.jedi.options.theme){case"bootstrap3":this.theme=new Dt(e);break;case"bootstrap4":this.theme=new Ft(e);break;case"bootstrap5":this.theme=new Ut(e);break;default:this.theme=new we(e)}}setContainerAttributes(){this.control.container.setAttribute("data-path",this.instance.path),this.control.container.setAttribute("data-type",H(this.instance.schema))}build(){}coerceValue(){const e=V(this.instance.schema);d(e)&&!e.includes(this.instance.getValue())&&d(e[0])&&this.instance.setValue(e[0],!1)}addEventListeners(){}showValidationErrors(e){if(this.instance.jedi.options.showErrors==="never"||m(this.instance.schema,"showErrors")==="never")return;this.control.messages.innerHTML="";const s=I(this.instance.schema)||this.instance.getKey();e.forEach(r=>{r.messages.forEach(i=>{const a=this.getInvalidFeedback({message:s+": "+i});this.control.messages.appendChild(a)})})}getInvalidFeedback(e){return this.theme.getInvalidFeedback(e)}disable(){this.disabled=!0,this.refreshUI()}enable(){this.disabled=!1,this.refreshUI()}refreshUI(){this.refreshInteractiveElements()}refreshInteractiveElements(){this.control.container.querySelectorAll("button, input, select, textarea").forEach(t=>{this.disabled||this.readOnly?t.setAttribute("disabled",""):t.removeAttribute("disabled","")})}sanitize(e){return e}destroy(){this.control.container&&this.control.container.parentNode&&this.control.container.parentNode.removeChild(this.control.container),Object.keys(this).forEach(e=>{delete this[e]})}};class Ye extends U{build(){this.control=this.theme.getMultipleControl({title:"Options",titleHidden:m(this.instance.schema,"titleHidden"),id:A(this.instance.path),description:j(this.instance.schema),switcherOptionValues:this.instance.switcherOptionValues,switcherOptionsLabels:this.instance.switcherOptionsLabels})}addEventListeners(){this.control.switcher.input.addEventListener("change",()=>{const e=Number(this.control.switcher.input.value);this.instance.switchInstance(e)})}refreshUI(){this.refreshInteractiveElements(),this.control.childrenSlot.innerHTML="",this.control.childrenSlot.appendChild(this.instance.activeInstance.ui.control.container),this.control.switcher.input.value=this.instance.index,this.disabled||this.instance.isReadOnly()?this.instance.activeInstance.ui.disable():this.instance.activeInstance.ui.enable()}getInvalidFeedback(e){return this.theme.getAlert(e)}}class Kt extends F{setUI(){this.ui=new Ye(this)}prepare(){this.instances=[],this.activeInstance=null,this.activeInstanceChanged=!0,this.index=0,this.schemas=[],this.switcherOptionValues=[],this.switcherOptionsLabels=[],this.ifThenElseShemas=[],this.traverseSchema(this.schema),delete this.schema.if,delete this.schema.then,delete this.schema.else;let e=0;this.ifThenElseShemas.forEach(i=>{d(i.then)&&(this.schemas.push(K({},O(this.schema),i.then)),this.switcherOptionValues.push(e),this.switcherOptionsLabels.push(JSON.stringify(i.then)),e++),d(i.else)&&(this.schemas.push(K({},O(this.schema),i.else)),this.switcherOptionValues.push(e),this.switcherOptionsLabels.push(JSON.stringify(i.else)),e++)});const t=O(this.schema);delete t.if,delete t.then,delete t.else;const s=this.jedi.createInstance({jedi:this.jedi,schema:t,path:this.path,parent:this.parent});this.schemas.forEach(i=>{const a=this.jedi.createInstance({jedi:this.jedi,schema:i,path:this.path,parent:this.parent});a.unregister(),a.on("change",()=>{const o=this.activeInstance.getValue();this.getFittestIndex(o)!==this.index?this.setValue(o):(this.value=this.activeInstance.getValue(),this.emit("change"))}),this.instances.push(a),this.register()}),this.on("set-value",i=>{this.instances.forEach(l=>{const c=l.getValue();let h=i;f(c)&&f(h)&&(h=rt(c,h)),l.setValue(h,!1)});const a=this.getFittestIndex(i);a!==this.index&&(this.switchInstance(a),this.emit("change"))}),this.value=s.getValue(),s.destroy();const r=this.getFittestIndex(this.value);this.switchInstance(r)}switchInstance(e){this.index=e,this.activeInstance=this.instances[this.index],this.value=this.activeInstance.getValue(),this.emit("change")}traverseSchema(e){const t=Re(e);if(d(t)){const s=Be(e),r=Ve(e);this.ifThenElseShemas.push({if:t,then:d(s)?s:{}}),this.ifThenElseShemas.push({if:t,else:d(r)?r:{}})}}getFittestIndex(e){let t=this.index;return this.ifThenElseShemas.forEach((s,r)=>{const i=new P({schema:s.if,data:e}),a=i.getErrors();i.destroy(),a.length===0&&s.then&&(t=r),a.length>0&&s.else&&(t=r)}),t}destroy(){this.instances.forEach(e=>{e.destroy()}),super.destroy()}getAllOfCombinations(e){const t=[],s=(i,a)=>({...i,...a}),r=(i,a)=>{if(a.length===0){t.push(i);return}const o=a[0];r(s(i,o),a.slice(1)),r(i,a.slice(1))};for(let i=0;i<e.length;i++)r(e[i],e.slice(i+1));return t.sort((i,a)=>Object.keys(i).length-Object.keys(a).length),t}}class $t extends F{setUI(){this.ui=new Ye(this)}prepare(){this.instances=[],this.activeInstance=null,this.lastIndex=0,this.index=0,this.schemas=[],this.switcherOptionValues=[],this.switcherOptionsLabels=[],this.on("set-value",()=>{this.onSetValue()});const e=H(this.schema);if(d($(this.schema))||d(J(this.schema))){const s=d($(this.schema))?$(this.schema):J(this.schema),r=O(this.schema);delete r.anyOf,delete r.oneOf,delete r.options,s.forEach((i,a)=>{i={...r,...i},this.jedi.refParser&&(i=this.jedi.refParser.expand(i));let o="Option-"+(a+1);const l=m(i,"switcherTitle"),c=I(i);d(c)&&(o=c),d(l)&&(o=l),this.switcherOptionValues.push(a),this.switcherOptionsLabels.push(o),this.schemas.push(i)})}else if(x(e))e.forEach((s,r)=>{const i=K(this.schema),a={...i,type:s,title:s[0].toUpperCase()+s.slice(1)};d(i.title)&&(a.title=i.title),this.switcherOptionValues.push(r),this.switcherOptionsLabels.push(s.charAt(0).toUpperCase()+s.slice(1)),this.schemas.push(a)});else if(e==="any"||!e){const s=O(this.schema);this.schemas=[{...s,type:"object"},{...s,type:"array"},{...s,type:"string"},{...s,type:"number"},{...s,type:"integer"},{...s,type:"boolean"},{...s,type:"null"}],this.schemas.forEach((r,i)=>{this.switcherOptionValues.push(i)}),this.switcherOptionsLabels=["Object","Array","String","Number","Integer","Boolean","Null"]}this.schemas.forEach(s=>{const r=this.jedi.createInstance({jedi:this.jedi,schema:s,path:this.path,parent:this.parent,value:O(this.value)});d(this.value)&&r.setValue(this.value,!1),r.unregister(),r.off("change"),r.on("change",()=>{this.value=this.activeInstance.getValue(),this.emit("change")}),this.instances.push(r),this.register()});const t=this.getFittestIndex(this.value);this.switchInstance(t,this.value)}switchInstance(e,t){this.lastIndex=this.index,this.index=e,this.activeInstance=this.instances[e],d(t)&&this.activeInstance.setValue(t,!1),this.setValue(this.activeInstance.getValue())}onSetValue(){if(Te(this.activeInstance.getValue(),this.value)){const e=this.getFittestIndex(this.value);this.switchInstance(e,this.value)}}getFittestIndex(e){let t=0,s,r;for(const i of this.instances){const a=this.jedi.validator.getErrors(e,i.schema,i.getKey(),i.path);(D(s)||D(r))&&(s=t,r=a),a.length<r.length&&(s=t,r=a),t++}return s}destroy(){this.instances.forEach(e=>{e.destroy()}),super.destroy()}}class qe extends U{build(){this.control=this.theme.getCheckboxControl({id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),description:j(this.instance.schema)})}addEventListeners(){this.control.input.addEventListener("change",()=>{this.instance.setValue(this.control.input.checked)})}sanitize(e){return!!e}refreshUI(){this.refreshInteractiveElements(),this.control.input.checked=this.instance.getValue()}}class zt extends qe{build(){this.control=this.theme.getRadiosControl({values:["false","true"],titles:m(this.instance.schema,"enumTitles")||["false","true"],id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),description:j(this.instance.schema)})}addEventListeners(){this.control.radios.forEach(e=>{e.addEventListener("change",()=>{const t=e.value==="true";this.instance.setValue(t)})})}refreshUI(){this.refreshInteractiveElements(),this.control.radios.forEach(e=>{const t=e.value==="true";e.checked=t===this.instance.getValue()})}}class et extends qe{build(){this.control=this.theme.getSelectControl({values:["false","true"],titles:m(this.instance.schema,"enumTitles")||["false","true"],id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),description:j(this.instance.schema)})}addEventListeners(){this.control.input.addEventListener("change",()=>{const e=this.control.input.value==="true";this.instance.setValue(e)})}refreshUI(){this.refreshInteractiveElements(),this.control.input.value=this.instance.getValue()===!0?"true":"false"}}class Jt extends F{setUI(){const e=H(this.schema),t=q(this.schema);e==="boolean"&&t==="radio"?this.ui=new zt(this):e==="boolean"&&t==="select"?this.ui=new et(this):e==="boolean"&&t==="checkbox"?this.ui=new qe(this):e==="boolean"&&(this.ui=new et(this))}}class Ne extends U{build(){this.propertyActivators={};const e=this.instance.schema.options||{};let t=!0;const s=ke(this.instance.schema);d(s)&&s===!1&&(t=!1);let r=!1;d(this.instance.jedi.options.enablePropertiesToggle)&&(r=this.instance.jedi.options.enablePropertiesToggle),d(e.enablePropertiesToggle)&&(r=e.enablePropertiesToggle),this.control=this.theme.getObjectControl({title:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),id:A(this.instance.path),description:j(this.instance.schema),enablePropertiesToggle:r,addProperty:t,enableCollapseToggle:this.instance.jedi.options.enableCollapseToggle||m(this.instance.schema,"enableCollapseToggle"),startCollapsed:this.instance.jedi.options.startCollapsed||m(this.instance.schema,"startCollapsed")})}addEventListeners(){this.control.addPropertyBtn.addEventListener("click",()=>{const e=this.control.addPropertyControl.input.value.split(" ").join("");if(e.length===0||d(this.instance.value[e]))return;const r=this.instance.getPropertySchema(e),i=this.instance.createChild(r,e);i.activate(),this.instance.setValue(this.instance.value),this.control.addPropertyControl.input.value="";const a=this.control.ariaLive;a.innerHTML="";const o=I(i.schema),l=d(o)?o:e,c=this.theme.getAriaLiveMessage();c.textContent=l+" field was added to the form",a.appendChild(c),this.control.propertiesContainer.close(),this.control.propertiesContainer.showModal()})}sanitize(e){return f(e)?e:{}}getInvalidFeedback(e){return this.theme.getAlert(e)}refreshPropertiesSlot(){const e=m(this.instance.schema,"enablePropertiesToggle");if(Oe(this.instance.jedi.options.enablePropertiesToggle,!0)||Oe(e,!0)){const t=Object.keys(this.instance.properties),s=this.instance.children.map(i=>i.getKey());[...t,...s].forEach(i=>{const a=this.instance.isRequired(i),o=this.instance.isDependentRequired(i),l=!a&&!o,c=this.propertyActivators[i],h=this.control.ariaLive,u=this.instance.getPropertySchema(i),p=I(u),g=this.instance.path+this.instance.jedi.pathSeparator+i,C=A(g)+"-activator",v=d(p)?p:i;if(l&&!c){const y=this.theme.getCheckboxControl({id:C,label:v,titleHidden:!1}),S=y.input;this.propertyActivators[i]=S,S.addEventListener("change",()=>{h.innerHTML="";const w=this.theme.getAriaLiveMessage();S.checked?(this.instance.getChild(i)||this.instance.createChild(u,i),this.instance.getChild(i).activate(),w.textContent=v+" field was added to the form",h.appendChild(w)):(this.instance.getChild(i).deactivate(),w.textContent=v+" field was removed from the form",h.appendChild(w)),this.control.propertiesContainer.close(),this.control.propertiesContainer.showModal()}),this.control.propertiesActivators.appendChild(y.container)}const L=this.propertyActivators[i];L&&(L.disabled=this.disabled,L.checked=N(this.instance.getValue(),i))})}}refreshEditors(){this.instance.children.forEach(e=>{e.isActive?(e.ui.control.container.parentNode===null&&this.control.childrenSlot.appendChild(e.ui.control.container),this.disabled||this.instance.isReadOnly()?e.ui.disable():e.ui.enable()):e.ui.control.container.parentNode&&e.ui.control.container.parentNode.removeChild(e.ui.control.container)})}refreshUI(){this.refreshInteractiveElements(),this.refreshPropertiesSlot(),this.refreshEditors()}}class Gt extends Ne{refreshEditors(){for(;this.control.childrenSlot.firstChild;)this.control.childrenSlot.removeChild(this.control.childrenSlot.lastChild);let e=this.theme.getRow();this.control.childrenSlot.appendChild(e),this.instance.children.forEach(t=>{if(t.isActive){const s=m(t.schema,"columns")||12,r=m(t.schema,"offset")||0,i=this.theme.getCol(12,s,r);m(t.schema,"newRow")===!0&&(e=this.theme.getRow(),this.control.childrenSlot.appendChild(e)),e.appendChild(i),i.appendChild(t.ui.control.container),this.disabled||this.instance.isReadOnly()?t.ui.disable():t.ui.enable()}})}}class Zt extends Ne{init(){super.init(),this.activeTabIndex=0}refreshEditors(){for(;this.control.childrenSlot.firstChild;)this.control.childrenSlot.removeChild(this.control.childrenSlot.lastChild);const e=this.instance.schema["x-control-cols"],t=this.instance.schema["x-control-stacked"],s=this.instance.schema["x-control-variant"],r=this.theme.getRow(),i=d(e)?e:3,a=this.theme.getCol(12,i),o=this.theme.getCol(12,12-i),l=this.theme.getTabContent(),c=this.theme.getTabList({stacked:d(t)?t:!1,type:d(s)?s:"pils"});this.control.childrenSlot.appendChild(r),r.appendChild(a),r.appendChild(o),a.appendChild(c),o.appendChild(l),this.instance.children.forEach((h,u)=>{if(h.isActive){const p=u===this.activeTabIndex,g=A(h.path),C=I(h.schema),v=this.theme.getTab({title:d(C)?C:h.getKey(),id:g,active:p});v.list.addEventListener("click",()=>{this.activeTabIndex=u}),this.theme.setTabPaneAttributes(h.ui.control.container,p,g),c.appendChild(v.list),l.appendChild(h.ui.control.container),this.disabled||this.instance.isReadOnly()?h.ui.disable():h.ui.enable()}})}}class _t extends F{setUI(){const e=H(this.schema),t=q(this.schema),s=this.schema["x-control"];e==="object"&&t==="grid"?this.ui=new Gt(this):e==="object"&&s==="nav"?this.ui=new Zt(this):this.ui=new Ne(this)}prepare(){this.properties={};const e=ve(this.schema);d(e)&&Object.keys(e).forEach(t=>{const s=e[t];this.properties[t]={schema:s};let r=!0;const i=this.jedi.options.deactivateNonRequired,a=m(this.schema,"deactivateNonRequired"),o=m(s,"deactivateNonRequired");this.isNotRequired(t)&&d(i)&&i===!0&&(r=!1),this.isNotRequired(t)&&d(a)&&a===!0&&(r=!1),this.isNotRequired(t)&&d(o)&&o===!0&&(r=!1),r&&this.createChild(s,t)}),this.refreshInstances(),this.on("set-value",()=>{this.refreshInstances()})}isRequired(e){const t=_e(this.schema);return d(t)&&t.includes(e)}isDependentRequired(e){const t=Ke(this.schema);if(d(t)){let s=[];return Object.keys(t).forEach(r=>{d(this.value[r])&&(s=t[r].filter(a=>!N(this.value,a)))}),s.includes(e)}return!1}createChild(e,t,s,r=!1){const i=this.jedi.createInstance({jedi:this.jedi,schema:e,path:this.path+this.jedi.pathSeparator+t,parent:this,value:O(s)});this.children.push(i),this.value[t]=i.getValue();const a=this.jedi.options.deactivateNonRequired||m(this.schema,"deactivateNonRequired");return this.isNotRequired(t)&&d(a)&&a===!0&&!r&&i.deactivate(),i}isNotRequired(e){return!this.isRequired(e)&&!this.isDependentRequired(e)}deleteChild(e){for(let t=this.children.length-1;t>=0;t--){const s=this.children[t];s.getKey()===e&&(s.destroy(),this.children.splice(t,1),this.onChildChange())}}getChild(e){return this.children.find(t=>e===t.getKey().split(this.jedi.pathSeparator).pop())}getPropertySchema(e){let t;const s=ke(this.schema),r=ve(this.schema),i=be(this.schema);return d(r)&&N(r,e)?t=r[e]:d(i)&&Object.keys(i).forEach(a=>{new RegExp(a).test(e)&&(t=i[a])}),D(t)&&d(s)&&(t=s),D(t)&&(t={}),t}onChildChange(){const e={};this.children.forEach(t=>{t.isActive&&(e[t.getKey()]=t.getValue())}),this.value=e,this.emit("change")}refreshInstances(){const e=this.getValue();if(f(e)){Object.keys(e).forEach(t=>{const s=this.getChild(t);if(s){s.activate();const r=s.getValue(),i=e[s.getKey()];Te(r,i)&&s.setValue(i,!1)}else{const r=this.getPropertySchema(t);this.createChild(r,t,e[t],!0)}});for(let t=this.children.length-1;t>=0;t--){const s=this.children[t],r=s.getKey();D(e[r])&&(this.getChild(r)?s.deactivate():this.deleteChild(r))}}}}class tt extends U{build(){this.control=this.theme.getArrayControl({title:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),id:A(this.instance.path),description:j(this.instance.schema),enableCollapseToggle:this.instance.jedi.options.enableCollapseToggle||m(this.instance.schema,"enableCollapseToggle"),startCollapsed:this.instance.jedi.options.startCollapsed||m(this.instance.schema,"startCollapsed")})}addEventListeners(){this.control.addBtn.addEventListener("click",()=>{this.instance.addItem()})}getInvalidFeedback(e){return this.theme.getAlert(e)}sanitize(e){return x(e)?e:[]}refreshUI(){this.refreshInteractiveElements();const e=ze(this.instance.schema),t=Je(this.instance.schema);d(e)&&e===this.instance.value.length&&this.control.addBtn.setAttribute("disabled",""),this.control.childrenSlot.innerHTML="",this.instance.children.forEach(s=>{const r=Number(s.getKey()),i=this.theme.getDeleteItemBtn(),a=this.theme.getMoveUpItemBtn(),o=this.theme.getMoveDownItemBtn(),l=this.theme.getBtnGroup();s.ui.control.arrayActions.innerHTML="",s.ui.control.arrayActions.appendChild(l),l.appendChild(i),l.appendChild(a),l.appendChild(o),this.control.childrenSlot.appendChild(s.ui.control.container),i.addEventListener("click",()=>{const c=Number(s.path.split(this.instance.jedi.pathSeparator).pop());this.instance.deleteItem(c)}),a.addEventListener("click",()=>{const c=r-1;this.instance.move(r,c)}),o.addEventListener("click",()=>{const c=r+1;this.instance.move(r,c)}),this.disabled||this.instance.isReadOnly()?s.ui.disable():s.ui.enable(),d(t)&&this.instance.value.length<=t&&i.setAttribute("disabled","")})}}class Wt extends tt{init(){super.init(),this.activeTabIndex=0}addEventListeners(){this.control.addBtn.addEventListener("click",()=>{this.activeTabIndex=this.instance.value.length,this.instance.addItem()})}refreshUI(){this.refreshInteractiveElements(),this.control.childrenSlot.innerHTML="";const e=m(this.instance.schema,"navCols"),t=m(this.instance.schema,"navStacked"),s=m(this.instance.schema,"navType"),r=this.theme.getRow(),i=d(e)?e:3,a=this.theme.getCol(12,i),o=this.theme.getCol(12,12-i),l=this.theme.getTabContent(),c=this.theme.getTabList({stacked:d(t)?t:!1,type:d(s)?s:"pils"});this.control.childrenSlot.appendChild(r),r.appendChild(a),r.appendChild(o),a.appendChild(c),o.appendChild(l),this.instance.children.forEach((h,u)=>{const p=this.theme.getDeleteItemBtn(),g=this.theme.getMoveUpItemBtn(),C=this.theme.getMoveDownItemBtn();h.ui.control.arrayActions.innerHTML="",h.ui.control.arrayActions.appendChild(p),h.ui.control.arrayActions.appendChild(g),h.ui.control.arrayActions.appendChild(C),this.control.childrenSlot.appendChild(h.ui.control.container);let v;const L=m(this.instance.schema,"itemTemplate");if(L){const k=L,Pe={i0:u,i1:u+1,value:h.getValue()};v=E(k,Pe)}else{const k=I(h.schema);v=d(k)?k+" "+(u+1):h.getKey()}p.addEventListener("click",()=>{this.activeTabIndex=ot(u-1,0,this.instance.value.length-1),this.instance.deleteItem(u)}),g.addEventListener("click",()=>{const k=u-1;this.activeTabIndex=k,this.instance.move(u,k)}),C.addEventListener("click",()=>{const k=u+1;this.activeTabIndex=k,this.instance.move(u,k)});const y=u===this.activeTabIndex,S=A(h.path),w=this.theme.getTab({title:v,id:S,active:y});w.list.addEventListener("click",()=>{this.activeTabIndex=u}),this.theme.setTabPaneAttributes(h.ui.control.container,y,S),c.appendChild(w.list),l.appendChild(h.ui.control.container),this.disabled||this.instance.isReadOnly()?h.ui.disable():h.ui.enable(),u===0&&g.setAttribute("disabled",""),this.instance.value.length-1===u&&C.setAttribute("disabled","")})}}class Xt extends F{setUI(){const e=H(this.schema),t=q(this.schema);e==="array"&&t==="nav"?this.ui=new Wt(this):this.ui=new tt(this)}prepare(){this.refreshChildren(),this.on("set-value",()=>{this.refreshChildren()})}createItemInstance(e){let t;const s=this.children.length,r=$e(this.schema),i=He(this.schema);t=d(r)?r:{},d(i)&&d(i[s])&&(t=i[s]);const o=this.jedi.createInstance({jedi:this.jedi,schema:t,path:this.path+this.jedi.pathSeparator+s,parent:this,value:O(e)});return d(e)&&o.setValue(e,!1),o}move(e,t){const s=O(this.getValue()),r=s[e];s.splice(e,1),s.splice(t,0,r),this.setValue(s)}addItem(){const e=this.createItemInstance(),t=O(this.getValue());t.push(e.getValue()),e.destroy(),this.setValue(t)}deleteItem(e){const s=O(this.getValue()).filter((r,i)=>i!==e);this.setValue(s)}onChildChange(){const e=[];this.children.forEach(t=>{e.push(t.getValue())}),this.value=e,this.emit("change")}refreshChildren(){this.children=[];const e=this.getValue();x(e)&&e.forEach(t=>{const s=this.createItemInstance(t);this.children.push(s)})}}class Ae extends U{build(){const e=["hidden","color","date","datetime-local","email","number","month","password","search","time","tel","text","textarea","url","week"],t=q(this.instance.schema);this.control=this.theme.getInputControl({type:e.includes(t)?t:"text",id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden")||t==="hidden",description:j(this.instance.schema)}),t==="color"&&this.instance.value.length===0&&this.instance.setValue("#000000",!1)}addEventListeners(){this.control.input.addEventListener("change",()=>{this.instance.setValue(this.control.input.value)})}sanitize(e){return String(e)}refreshUI(){this.refreshInteractiveElements(),this.control.input.value=this.instance.getValue()}}class Qt extends Ae{build(){this.control=this.theme.getRadiosControl({values:V(this.instance.schema),titles:m(this.instance.schema,"enumTitles")||V(this.instance.schema),id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),description:j(this.instance.schema)})}addEventListeners(){this.control.radios.forEach(e=>{e.addEventListener("change",()=>{this.instance.setValue(e.value)})})}refreshUI(){this.refreshInteractiveElements(),this.control.radios.forEach(e=>{e.checked=e.value===this.instance.getValue()})}}class Yt extends Ae{build(){this.control=this.theme.getSelectControl({values:V(this.instance.schema),titles:m(this.instance.schema,"enumTitles")||V(this.instance.schema),id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),description:j(this.instance.schema)}),this.control.input.addEventListener("change",()=>{this.instance.setValue(this.control.input.value)})}}class es extends U{build(){this.control=this.theme.getTextareaControl({id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden")||q(this.instance.schema)==="hidden",description:j(this.instance.schema)})}addEventListeners(){this.control.input.addEventListener("change",()=>{this.instance.setValue(this.control.input.value)})}sanitize(e){return String(e)}refreshUI(){this.refreshInteractiveElements(),this.control.input.value=this.instance.getValue()}}class ts extends Ae{build(){this.control=this.theme.getInputControl({type:"text",id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),description:j(this.instance.schema)});try{new window.Awesomplete(this.control.input,Ge(this.instance.schema,"awesomplete")),this.control.container.querySelector(".awesomplete").style.display="block"}catch(e){console.error("Awesomplete is not available or not loaded correctly.",e)}}addEventListeners(){}refreshUI(){this.refreshInteractiveElements()}}class ss extends F{setUI(){const e=H(this.schema),t=V(this.schema),s=q(this.schema),r=Ge(this.schema,"awesomplete");e==="string"&&d(t)&&s==="radio"?this.ui=new Qt(this):e==="string"&&s==="textarea"?this.ui=new es(this):e==="string"&&d(t)?this.ui=new Yt(this):e==="string"&&d(r)?this.ui=new ts(this):e==="string"&&(this.ui=new Ae(this))}}class De extends U{build(){this.control=this.theme.getInputControl({type:"number",id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden")||q(this.instance.schema)==="hidden",description:j(this.instance.schema)})}addEventListeners(){this.control.input.addEventListener("change",()=>{const e=this.sanitize(this.control.input.value);this.instance.setValue(e)})}sanitize(e){return H(this.instance.schema)==="integer"?Math.floor(Number(e)):Number(e)}refreshUI(){this.refreshInteractiveElements();const e=this.instance.getValue();M(e)&&(this.control.input.value=this.instance.getValue())}}class is extends De{build(){this.control=this.theme.getRadiosControl({values:V(this.instance.schema),titles:m(this.instance.schema,"enumTitles")||V(this.instance.schema),id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),description:j(this.instance.schema)})}addEventListeners(){this.control.radios.forEach(e=>{e.addEventListener("change",()=>{const t=this.sanitize(e.value);this.instance.setValue(t)})})}refreshUI(){this.refreshInteractiveElements(),this.control.radios.forEach(e=>{e.checked=Number(e.value)===Number(this.instance.getValue())})}}class ns extends De{build(){this.control=this.theme.getSelectControl({values:V(this.instance.schema),titles:m(this.instance.schema,"enumTitles")||V(this.instance.schema),id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden"),description:j(this.instance.schema)})}addEventListeners(){this.control.input.addEventListener("change",()=>{const e=this.sanitize(this.control.input.value);this.instance.setValue(e)})}}class rs extends F{setUI(){const e=H(this.schema),t=V(this.schema),s=q(this.schema),r=e==="number"||e==="integer";r&&d(t)&&s==="radio"?this.ui=new is(this):r&&d(t)?this.ui=new ns(this):r&&(this.ui=new De(this))}}class as extends U{build(){this.control=this.theme.getNullControl({id:A(this.instance.path),label:I(this.instance.schema)||this.instance.getKey(),titleHidden:m(this.instance.schema,"titleHidden")||q(this.instance.schema)==="hidden",description:j(this.instance.schema)})}sanitize(){return null}}class os extends F{setUI(){this.ui=new as(this)}}class ls extends Qe{constructor(e){super(),this.options=Object.assign({refParser:null,schema:{},data:void 0,validateFormat:!1,mergeAllOf:!1},e),this.rootName="#",this.pathSeparator="/",this.instances={},this.root=null,this.theme=null,this.validator=null,this.schema={},this.refParser=this.options.refParser?this.options.refParser:null,this.init(),this.bindEventListeners()}init(){this.schema=this.options.schema,this.validator=new Mt({refParser:this.refParser,validateFormat:this.options.validateFormat}),this.root=this.createInstance({jedi:this,schema:this.options.schema,path:this.rootName}),d(this.options.data)&&this.root.setValue(this.options.data,!1)}bindEventListeners(){this.root&&this.root.on("change",()=>{this.emit("change")})}register(e){this.instances[e.path]=e}unregister(e){this.instances[e.path]=null,delete this.instances[e.path]}createInstance(e){if(this.options.mergeAllOf||m(e.schema,"mergeAllOf")){const c=Me(e.schema);d(c)&&c.forEach(h=>{e.schema=K({},e.schema,h)})}this.refParser&&(e.schema=this.refParser.expand(e.schema,e.path));const s=H(e.schema),r=J(e.schema),i=$(e.schema),a=Re(e.schema),o=Be(e.schema),l=Ve(e.schema);if(d(i)||d(r)||s==="any"||x(s)||D(s))return new $t(e);if(d(a)&&(d(o)||d(l)))return new Kt(e);if(s==="object")return new _t(e);if(s==="array")return new Xt(e);if(s==="string")return new ss(e);if(s==="number"||s==="integer")return new rs(e);if(s==="boolean")return new Jt(e);if(s==="null")return new os(e)}getValue(){return this.root.getValue()}setValue(){this.root.setValue(...arguments)}getInstance(e){return this.instances[e]}getErrors(){let e=[];return Object.keys(this.instances).forEach(t=>{const s=this.instances[t];e=[...e,...s.getErrors()]}),e}destroy(){this.root.destroy(),Object.keys(this).forEach(e=>{delete this[e]})}}const P=ls;class cs extends P{constructor(e){super(e),this.options=Object.assign({container:null,enablePropertiesToggle:!1,enableCollapseToggle:!1,startCollapsed:!1,deactivateNonRequired:!1,showErrors:"change"},e),this.theme=null}init(){super.init(),this.options.container&&(this.container=this.options.container,this.appendHiddenInput(),this.container.appendChild(this.root.ui.control.container),this.container.classList.add("jedi-ready"))}bindEventListeners(){super.bindEventListeners(),console.log("bindEventListeners",this.hiddenInput),this.hiddenInput&&this.on("change",()=>{this.hiddenInput.value=JSON.stringify(this.getValue())})}appendHiddenInput(){console.log("appendHiddenInput",this.hiddenInput);const e=this.root.ui.theme.getInputControl({type:"hidden",id:"jedi-hidden-input"});this.hiddenInput=e.input,this.hiddenInput.setAttribute("name","json"),this.hiddenInput.removeAttribute("aria-describedby"),this.container.appendChild(this.hiddenInput),this.hiddenInput.value=JSON.stringify(this.getValue())}disable(){this.root.ui.disable()}enable(){this.root.ui.enable()}destroy(){this.options.container&&(this.container.innerHTML=""),super.destroy()}}class ds{constructor(){this.refs={},this.data={}}async dereference(e){for(await this.collectRefs(e);this.refsResolved()===!1;)await this.collectRefs(e)}refsResolved(){return Object.values(this.refs).every(e=>e!==null)}async collectRefs(e,t="#"){if(!(typeof e!="object"||e===null))for(const[s,r]of Object.entries(e)){const i=t?`${t}/${s}`:`/${s}`;if(this.hasRef(e)){const a=e.$ref;if(this.isExternalRef(a)){const o=await this.load(a);this.refs[a]=o,await this.collectRefs(o,i)}else this.refs[a]=this.data[a]??null}this.data[t]=e,await this.collectRefs(r,i)}}hasRef(e){return typeof e.$ref<"u"&&typeof e.$ref=="string"}isExternalRef(e){return typeof e!="string"?!1:e.startsWith("http")||e.startsWith("https")}isObject(e){return e!==null&&typeof e=="object"}expand(e){const t=JSON.parse(JSON.stringify(e));if(this.isObject(t)&&this.hasRef(t)){const s=t.$ref;return delete t.$ref,this.expand(K({},this.refs[s],t))}return t}async load(e){try{const t=await fetch(e);if(!t.ok)throw new Error("Network response was not ok");return await t.json()}catch(t){throw console.error("Error loading",e,t),t}}}return{RefParser:ds,Editor:cs,Validator:P}});
