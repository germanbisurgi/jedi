!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var s=class{setAttributes(t,e={}){Object.keys(e).forEach(i=>{t.setAttribute(i,e[i])})}addInputError(t,e){const i=document.createElement("p");i.classList.add("jedi-error-message"),i.textContent=e,t.appendChild(i)}removeInputError(t){const e='[data-path="'+t.getAttribute("data-path")+'"] > .jedi-error-message';t.querySelectorAll(e).forEach(e=>{t.removeChild(e)})}getButton(t){const e=document.createElement("button");return e.textContent=t,e}getContainer(){return document.createElement("div")}getDebugContainer(){return document.createElement("pre")}getLabel(t,e={}){const i=document.createElement("label");return i.textContent=t,this.setAttributes(i,e),i}getInput(t={}){const e=document.createElement("input");return this.setAttributes(e,t),e}getRadioGroup(t,e,i){const s=this.getContainer();return t.forEach((t,n)=>{const r=e[n],a=this.getLabel(r,{for:i+"["+t+"]"}),h=this.getInput({type:"radio",value:t,id:i+"["+t+"]",name:i});s.appendChild(a),s.appendChild(h)}),s}getSelect(t,e,i){const s=document.createElement("select");return s.setAttribute("id",i),t.forEach((t,i)=>{const n=document.createElement("option");n.setAttribute("value",t),n.textContent=e[i],s.appendChild(n)}),s}getOutput(t={}){const e=document.createElement("output");return this.setAttributes(e,t),e}};var n=new class{clone(t){return JSON.parse(JSON.stringify(t))}equal(t,e){return JSON.stringify(t)===JSON.stringify(e)}different(t,e){return JSON.stringify(t)!==JSON.stringify(e)}isSet(t){return void 0!==t}isNumber(t){return"number"==typeof t}isInteger(t){return this.isNumber(t)&&t===Math.floor(t)}isString(t){return"string"==typeof t}isBoolean(t){return"boolean"==typeof t}isArray(t){return Array.isArray(t)}isObject(t){return!this.isNull(t)&&!this.isArray(t)&&"object"==typeof t}isNull(t){return null===t}getSchemaEnumTitles(t){return!!(t&&t.options&&t.options.enumTitles&&this.isArray(t.options.enumTitles))&&t.options.enumTitles}getSchemaEnum(t){return!!(t&&t.enum&&this.isArray(t.enum))&&t.enum}getSchemaTitle(t){return t&&t.title?t.title:""}hasNumericType(t){return"number"===t.type||"integer"===t.type}hasFormatRadio(t){return t.format&&"radio"===t.format}hasFormatSelect(t){return t.format&&"select"===t.format}};var r=class{constructor(t){this.jedi=t.jedi,this.schema=t.schema,this.value=t.value||void 0,this.path=t.path||"root",this.parent=t.parent||null,this.container=null,this.debugContainer=null,this.childEditors=[],this.init()}init(){this.setContainer(),this.build(),this.setDefaultValue(),this.showValidationErrors(),this.register()}getKey(){return this.path.split(".").pop()}setContainer(){this.container=this.jedi.theme.getContainer(),this.container.setAttribute("data-path",this.path),this.container.setAttribute("data-type",this.schema.type),this.jedi.debug&&(this.debugContainer=this.jedi.theme.getDebugContainer(),this.container.appendChild(this.debugContainer))}build(){}register(){this.jedi.registerEditor(this)}unregister(){this.jedi.unregisterEditor(this)}setDefaultValue(){let t;"boolean"===this.schema.type&&(t=!1),"number"===this.schema.type&&(t=0),"integer"===this.schema.type&&(t=0),"string"===this.schema.type&&(t=""),"object"===this.schema.type&&(t={}),"array"===this.schema.type&&(t=[]);n.isSet(this.schema.default)&&(t=this.schema.default),this.setValue(t,!1)}getValue(){return this.value}sanitize(t){return t}setValue(t,e=!0){t=this.sanitize(t),this.value=t,e&&this.onChange(),this.refreshUI(),this.refreshDebug(),this.showValidationErrors()}refreshUI(){}refreshDebug(){this.jedi.debug&&(this.debugContainer.textContent=JSON.stringify(this.getValue(),null,2))}showValidationErrors(){const t=this.jedi.validator.validate(this.schema,this.getValue(),this.path);this.jedi.theme.removeInputError(this.container),t.forEach(t=>{this.jedi.theme.addInputError(this.container,t.message)})}onChange(){this.parent&&this.parent.onChildEditorChange()}onChildEditorChange(){}destroy(){this.unregister()}};var a=class extends r{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t);this.container.appendChild(e);const i=this.jedi.theme.getButton("add");this.container.appendChild(i),i.addEventListener("click",()=>{this.addItem()})}createItemEditor(){const t=this.jedi.createEditor({jedi:this.jedi,schema:this.schema.items,path:this.path+"."+this.childEditors.length,parent:this}),e=Number(t.getKey());t.input&&t.input.addEventListener("change",()=>{const i=n.clone(this.getValue());i[e]=n.clone(t.getValue()),this.setValue(i)});const i=this.jedi.theme.getButton("delete");if(t.container.appendChild(i),i.addEventListener("click",()=>{const e=Number(t.path.split(".").pop());this.deleteItem(e)}),0!==this.childEditors.length){const i=this.jedi.theme.getButton("move up");t.container.appendChild(i),i.addEventListener("click",()=>{const t=e-1;this.move(e,t)})}if(this.value.length-1!==e){const i=this.jedi.theme.getButton("move down");t.container.appendChild(i),i.addEventListener("click",()=>{const t=e+1;this.move(e,t)})}return t}move(t,e){const i=n.clone(this.getValue()),s=i[t];i.splice(t,1),i.splice(e,0,s),this.setValue(i)}addItem(){const t=this.createItemEditor(),e=n.clone(this.getValue());e.push(t.getValue()),t.destroy(),this.setValue(e)}deleteItem(t){if(window.confirm("Confirm to delete")){const e=n.clone(this.getValue()).filter((e,i)=>i!==t);this.setValue(e)}}refreshUI(){this.childEditors.forEach(t=>{this.container.removeChild(t.container),t.destroy()}),this.childEditors=[],this.getValue().forEach(t=>{const e=this.createItemEditor();e.setValue(t,!1),this.childEditors.push(e)}),this.childEditors.forEach(t=>{this.container.appendChild(t.container)})}};var h=class extends r{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e),this.input=this.jedi.theme.getInput({type:"checkbox",id:this.path}),this.container.appendChild(this.input),this.input.addEventListener("change",()=>{this.setValue(this.input.checked)})}sanitize(t){return Boolean(t)}refreshUI(){this.input.checked=this.value}};var o=class extends h{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e);const i=["false","true"],s=n.getSchemaEnumTitles(this.schema)||i;this.input=this.jedi.theme.getSelect(i,s,this.path),this.container.appendChild(this.input),this.input.addEventListener("change",()=>{const t="true"===this.input.value;this.setValue(t)})}refreshUI(){this.input.value=!0===this.getValue()?"true":"false"}};var u=class extends h{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e);const i=["false","true"],s=n.getSchemaEnumTitles(this.schema)||i,r=this.path,a=this.jedi.theme.getRadioGroup(i,s,r);this.container.appendChild(a);this.container.querySelectorAll('[name="'+r+'"]').forEach(t=>{t.addEventListener("change",()=>{const e="true"===t.value;this.setValue(e)})})}refreshUI(){const t=this.path,e=this.container.querySelectorAll('[name="'+t+'"]'),i=!0===this.getValue()?"true":"false",s=this.container.querySelector('[value="'+i+'"]');e.forEach(t=>{t.removeAttribute("checked")}),s&&s.setAttribute("checked","checked")}};var c=class extends r{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t);this.container.appendChild(e),Object.keys(this.schema.properties).forEach(t=>{const e=this.schema.properties[t],i=this.jedi.createEditor({jedi:this.jedi,schema:e,path:this.path+"."+t,parent:this});this.container.appendChild(i.container),this.childEditors.push(i)})}getValue(){return this.value={},this.childEditors.forEach(t=>{this.value[t.getKey()]=t.getValue()}),this.value}onChildEditorChange(){const t={};this.childEditors.forEach(e=>{t[e.getKey()]=e.getValue()}),this.setValue(t)}};var l=class extends r{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e);this.input=this.jedi.theme.getInput({type:["color","datetime-local","email","month","search","tel","text","time","url","week"].includes(this.schema.format)?this.schema.format:"text",id:this.path}),this.container.appendChild(this.input),this.input.addEventListener("change",()=>{this.setValue(this.input.value)})}sanitize(t){return String(t)}refreshUI(){this.input.value=this.getValue()}};var d=class extends l{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e);const i=n.getSchemaEnum(this.schema),s=n.getSchemaEnumTitles(this.schema)||i;this.input=this.jedi.theme.getSelect(i,s,this.path),this.container.appendChild(this.input),this.input.addEventListener("change",()=>{this.setValue(this.input.value)})}};var m=class extends l{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e);const i=n.getSchemaEnum(this.schema),s=n.getSchemaEnumTitles(this.schema)||i,r=this.path,a=this.jedi.theme.getRadioGroup(i,s,r);this.container.appendChild(a);this.container.querySelectorAll('[name="'+r+'"]').forEach(t=>{t.addEventListener("change",()=>{this.setValue(t.value)})})}refreshUI(){const t=this.path,e=this.container.querySelectorAll('[name="'+t+'"]'),i=this.container.querySelector('[value="'+this.getValue()+'"]');e.forEach(t=>{t.removeAttribute("checked")}),i&&i.setAttribute("checked","checked")}};var p=class extends r{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e),this.input=this.jedi.theme.getInput({type:"number",id:this.path}),this.container.appendChild(this.input),this.input.addEventListener("change",()=>{this.setValue(this.input.value)})}sanitize(t){return Number(t)}refreshUI(){this.input.value=this.getValue()}};var g=class extends p{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e);const i=n.getSchemaEnum(this.schema),s=n.getSchemaEnumTitles(this.schema)||i;this.input=this.jedi.theme.getSelect(i,s,this.path),this.container.appendChild(this.input),this.input.addEventListener("change",()=>{this.setValue(this.input.value)})}};var f=class extends p{build(){const t=n.getSchemaTitle(this.schema),e=this.jedi.theme.getLabel(t,{for:this.path});this.container.appendChild(e);const i=n.getSchemaEnum(this.schema),s=n.getSchemaEnumTitles(this.schema)||i,r=this.path,a=this.jedi.theme.getRadioGroup(i,s,r);this.container.appendChild(a);this.container.querySelectorAll('[name="'+r+'"]').forEach(t=>{t.addEventListener("change",()=>{this.setValue(t.value)})})}refreshUI(){const t=this.path,e=this.container.querySelectorAll('[name="'+t+'"]'),i=this.container.querySelector('[value="'+this.getValue()+'"]');e.forEach(t=>{t.removeAttribute("checked")}),i&&i.setAttribute("checked","checked")}};var b=class extends r{sanitize(t){return null}};var y=class{constructor(){this.resolvers=[t=>{const e=n.hasFormatRadio(t);if("boolean"===t.type&&e)return u},t=>{const e=n.hasFormatSelect(t);if("boolean"===t.type&&e)return o},t=>{if("boolean"===t.type)return h},t=>{if("object"===t.type)return c},t=>{if("array"===t.type)return a},t=>{const e=n.getSchemaEnum(t),i=n.hasFormatRadio(t);if("string"===t.type&&e&&i)return m},t=>{const e=n.getSchemaEnum(t);if("string"===t.type&&e)return d},t=>{if("string"===t.type)return l},t=>{const e=n.hasNumericType(t),i=n.getSchemaEnum(t),s=n.hasFormatRadio(t);if(e&&i&&s)return f},t=>{const e=n.hasNumericType(t),i=n.getSchemaEnum(t);if(e&&i)return g},t=>{if(n.hasNumericType(t))return p},t=>{if("null"===t.type)return b}]}addResolver(t){this.resolvers.unshift(t)}resolve(t){for(const e of this.resolvers){const i=e(t);if(n.isSet(i))return i}}};var v=class{constructor(){this.validators={type:(t,e,i)=>!{string:t=>n.isString(t),number:t=>n.isNumber(t),integer:t=>n.isInteger(t),boolean:t=>n.isBoolean(t),array:t=>n.isArray(t),object:t=>n.isObject(t),null:t=>n.isNull(t)}[t.type](e)&&{message:"Must be of type "+t.type,path:i},uniqueItems:(t,e,i)=>{if(!("array"===t.type))return;const s=t.uniqueItems,r=n.isSet(s)&&n.isBoolean(s);if(!r)return;const a={};let h=!1;for(let t=0;t<e.length;t++){const i=JSON.stringify(e[t]);if(a[i]){h=!0;break}a[i]=!0}return!(!r||!h)&&{message:"Must have unique items",path:i}},minItems:(t,e,i)=>{if(!("array"===t.type))return;const s=t.minItems,r=n.isSet(s)&&n.isNumber(s);if(!r)return;return!!(r&&e.length<s)&&{message:"Must have at least "+s+" items",path:i}},maxItems:(t,e,i)=>{if(!("array"===t.type))return;const s=t.maxItems,r=n.isSet(s)&&n.isNumber(s);if(!r)return;return!!(r&&e.length>s)&&{message:"Must have at most "+s+" items",path:i}},minLength:(t,e,i)=>{if(!("string"===t.type))return;const s=t.minLength,r=n.isSet(s)&&n.isNumber(s);if(!r)return;return!!(r&&e.length<s)&&{message:"Must be at least "+s+" characters long",path:i}},maxLength:(t,e,i)=>{if(!("string"===t.type))return;const s=t.maxLength,r=n.isSet(s)&&n.isNumber(s);if(!r)return;return!!(r&&e.length>s)&&{message:"Must be at most "+s+" characters long",path:i}},pattern:(t,e,i)=>{if(!("string"===t.type))return;const s=t.pattern,r=n.isSet(s)&&n.isString(s);if(!r)return;const a=new RegExp(s).test(e);return!(!r||a)&&{message:"Must be the pattern: "+s,path:i}},minimum:(t,e,i)=>{if(!("number"===t.type||"integer"===t.type))return;const s=t.exclusiveMinimum,r=t.minimum,a=n.isSet(r)&&n.isNumber(r);if(!a)return;const h=n.isSet(s)&&!0===s?r+1:r;return!!(a&&e<h)&&{message:"Must be at least "+h,path:i}},maximum:(t,e,i)=>{if(!("number"===t.type||"integer"===t.type))return;const s=t.exclusiveMaximum,r=t.maximum,a=n.isSet(r)&&n.isNumber(r);if(!a)return;const h=n.isSet(s)&&!0===s?r-1:r;return!!(a&&e>h)&&{message:"Must be less than "+h,path:i}},multipleOf:(t,e,i)=>{if(!("number"===t.type||"integer"===t.type))return;const s=t.multipleOf,r=n.isSet(s)&&n.isNumber(s);if(!r)return;const a=e/s===Math.floor(e/s);return!(!r||a)&&{message:"Must be multiple of "+s,path:i}},const:(t,e,i)=>{const s=t.const,r=n.isSet(s);if(!r)return;const a=JSON.stringify(e)!==JSON.stringify(s);return!(!r||!a)&&{message:"Must have value: "+s,path:i}},enum:(t,e,i)=>{const s=t.enum,r=n.isSet(s)&&n.isArray(s);if(!r)return;const a=!s.some(t=>JSON.stringify(e)===JSON.stringify(t));return!(!r||!a)&&{message:"Value must be one of the enumerated values",path:i}}}}addValidator(t,e){this.validators[t]=e}validate(t,e,i){const s=[];return Object.keys(this.validators).forEach(n=>{const r=(0,this.validators[n])(t,e,i);r&&s.push(r)}),s}};e.default=class{constructor(t){this.theme=new s,this.resolver=new y,this.validator=new v,this.container=t.container,this.debug=t.debug||!1,this.schema=t.schema,this.root=null,this.editors={},this.init()}init(){this.loadEditors()}registerEditor(t){this.editors[t.path]=t}unregisterEditor(t){this.editors[t.path]=null,delete this.editors[t.path]}loadEditors(){this.root=this.createEditor({jedi:this,schema:this.schema}),this.container.appendChild(this.root.container),this.container.classList.add("jedi-loaded")}createEditor(t){return new(this.resolver.resolve(t.schema))(t)}getValue(){return this.root.getValue()}getEditor(t){return this.editors[t]}}}]);